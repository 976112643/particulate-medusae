var Handlebars=function(){var a=function(){"use strict";function a(a){this.string=a}var b;return a.prototype.toString=function(){return""+this.string},b=a}(),b=function(a){"use strict";function b(a){return h[a]||"&amp;"}function c(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}function d(a){return a instanceof g?a.toString():a||0===a?(a=""+a,j.test(a)?a.replace(i,b):a):""}function e(a){return a||0===a?m(a)&&0===a.length?!0:!1:!0}var f={},g=a,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,j=/[&<>"'`]/;f.extend=c;var k=Object.prototype.toString;f.toString=k;var l=function(a){return"function"==typeof a};l(/x/)&&(l=function(a){return"function"==typeof a&&"[object Function]"===k.call(a)});var l;f.isFunction=l;var m=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===k.call(a):!1};return f.isArray=m,f.escapeExpression=d,f.isEmpty=e,f}(a),c=function(){"use strict";function a(a,b){var d;b&&b.firstLine&&(d=b.firstLine,a+=" - "+d+":"+b.firstColumn);for(var e=Error.prototype.constructor.call(this,a),f=0;f<c.length;f++)this[c[f]]=e[c[f]];d&&(this.lineNumber=d,this.column=b.firstColumn)}var b,c=["description","fileName","lineNumber","message","name","number","stack"];return a.prototype=new Error,b=a}(),d=function(a,b){"use strict";function c(a,b){this.helpers=a||{},this.partials=b||{},d(this)}function d(a){a.registerHelper("helperMissing",function(a){if(2===arguments.length)return void 0;throw new h("Missing helper: '"+a+"'")}),a.registerHelper("blockHelperMissing",function(b,c){var d=c.inverse||function(){},e=c.fn;return m(b)&&(b=b.call(this)),b===!0?e(this):b===!1||null==b?d(this):l(b)?b.length>0?a.helpers.each(b,c):d(this):e(b)}),a.registerHelper("each",function(a,b){var c,d=b.fn,e=b.inverse,f=0,g="";if(m(a)&&(a=a.call(this)),b.data&&(c=q(b.data)),a&&"object"==typeof a)if(l(a))for(var h=a.length;h>f;f++)c&&(c.index=f,c.first=0===f,c.last=f===a.length-1),g+=d(a[f],{data:c});else for(var i in a)a.hasOwnProperty(i)&&(c&&(c.key=i,c.index=f,c.first=0===f),g+=d(a[i],{data:c}),f++);return 0===f&&(g=e(this)),g}),a.registerHelper("if",function(a,b){return m(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||g.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})}),a.registerHelper("with",function(a,b){return m(a)&&(a=a.call(this)),g.isEmpty(a)?void 0:b.fn(a)}),a.registerHelper("log",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)})}function e(a,b){p.log(a,b)}var f={},g=a,h=b,i="1.3.0";f.VERSION=i;var j=4;f.COMPILER_REVISION=j;var k={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};f.REVISION_CHANGES=k;var l=g.isArray,m=g.isFunction,n=g.toString,o="[object Object]";f.HandlebarsEnvironment=c,c.prototype={constructor:c,logger:p,log:e,registerHelper:function(a,b,c){if(n.call(a)===o){if(c||b)throw new h("Arg not supported with multiple helpers");g.extend(this.helpers,a)}else c&&(b.not=c),this.helpers[a]=b},registerPartial:function(a,b){n.call(a)===o?g.extend(this.partials,a):this.partials[a]=b}};var p={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(a,b){if(p.level<=a){var c=p.methodMap[a];"undefined"!=typeof console&&console[c]&&console[c].call(console,b)}}};f.logger=p,f.log=e;var q=function(a){var b={};return g.extend(b,a),b};return f.createFrame=q,f}(b,c),e=function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=m;if(b!==c){if(c>b){var d=n[c],e=n[b];throw new l("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new l("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){if(!b)throw new l("No environment passed to template");var c=function(a,c,d,e,f,g){var h=b.VM.invokePartial.apply(this,arguments);if(null!=h)return h;if(b.compile){var i={helpers:e,partials:f,data:g};return f[c]=b.compile(a,{data:void 0!==g},b),f[c](d,i)}throw new l("The partial "+c+" could not be compiled when running in runtime-only mode")},d={escapeExpression:k.escapeExpression,invokePartial:c,programs:[],program:function(a,b,c){var d=this.programs[a];return c?d=g(a,b,c):d||(d=this.programs[a]=g(a,b)),d},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c={},k.extend(c,b),k.extend(c,a)),c},programWithDepth:b.VM.programWithDepth,noop:b.VM.noop,compilerInfo:null};return function(c,e){e=e||{};var f,g,h=e.partial?e:b;e.partial||(f=e.helpers,g=e.partials);var i=a.call(d,h,c,f,g,e.data);return e.partial||b.VM.checkRevision(d.compilerInfo),i}}function f(a,b,c){var d=Array.prototype.slice.call(arguments,3),e=function(a,e){return e=e||{},b.apply(this,[a,e.data||c].concat(d))};return e.program=a,e.depth=d.length,e}function g(a,b,c){var d=function(a,d){return d=d||{},b(a,d.data||c)};return d.program=a,d.depth=0,d}function h(a,b,c,d,e,f){var g={partial:!0,helpers:d,partials:e,data:f};if(void 0===a)throw new l("The partial "+b+" could not be found");return a instanceof Function?a(c,g):void 0}function i(){return""}var j={},k=a,l=b,m=c.COMPILER_REVISION,n=c.REVISION_CHANGES;return j.checkRevision=d,j.template=e,j.programWithDepth=f,j.program=g,j.invokePartial=h,j.noop=i,j}(b,c,d),f=function(a,b,c,d,e){"use strict";var f,g=a,h=b,i=c,j=d,k=e,l=function(){var a=new g.HandlebarsEnvironment;return j.extend(a,g),a.SafeString=h,a.Exception=i,a.Utils=j,a.VM=k,a.template=function(b){return k.template(b,a)},a},m=l();return m.create=l,f=m}(d,a,c,b,e);return f}();!function(a,b){"function"==typeof define&&define.amd?define("particulate",[],function(){return a.Particulate=b()}):"object"==typeof exports?module.exports=b():a.Particulate=b()}(this,function(){"use strict";function a(a,b){b=b||{},this.vector=new Float32Array(3),b.type&&(this.type=b.type),null!=a&&this.set(a)}function b(a){n.Force.call(this,a)}function c(a,b){b=b||{},n.Force.apply(this,arguments),this.intensity=b.intensity||.05,this.setRadius(b.radius||0)}function d(a,b,c){c=c||0,this.indices=new Uint16Array(a+c),this._count=a/b,this._itemSize=b,this._offset=c}function e(a,b,c,d){var e=b.length||arguments.length-1,f=a.length?a[0]:a,g=a.length?a[1]:a;n.Constraint.call(this,e,3),this.setAngle(f,g),this.setIndices(b,c,d)}function f(a,b,c){var d=c.length||1;n.Constraint.call(this,d,1,2),this.setAxis(a,b),this.setIndices(c)}function g(a,b,c){this.distance=c||0,this.friction=.05,this.bufferVec3=n.Vec3.create(2),this.setOrigin(a),this.setNormal(b)}function h(a,b){this.friction=.05,this.bufferVec3=n.Vec3.create(2),this.setBounds(a,b)}function i(a,b,c){var d=b.length||arguments.length-1,e=a.length?a[0]:a,f=a.length?a[1]:a;n.Constraint.call(this,d,2),this.setDistance(e,f),this.setIndices(b,c)}function j(a,b,c,d){var e=d.length||1;n.Constraint.call(this,e,1,3),this.bufferVec3=n.Vec3.create(1),this.setPlane(a,b,c),this.setIndices(d)}function k(a,b){var c=b.length||1;n.Constraint.call(this,c,1),this.bufferVec3=n.Vec3.create(1),this.setPosition(a),this.setIndices(b)}function l(a,b){var c="number"==typeof a,d=c?3*a:a.length,e=d/3,f=c?d:a;this.positions=new Float32Array(f),this.positionsPrev=new Float32Array(f),this.accumulatedForces=new Float32Array(d),this.weights=new Float32Array(e),this.setWeights(1),this._iterations=b||1,this._count=e,this._globalConstraints=[],this._localConstraints=[],this._pinConstraints=[],this._forces=[]}function m(a,b,c,d,e,f){var g=b[a];b[a]+=g-c[a]+d[a]*e*f,c[a]=g}var n;n={VERSION:"0.3.2"};var o=n.Collection={};o.removeAll=function(a,b){var c=a.indexOf(b);if(!(0>c))for(var d=a.length-1;d>=c;d--)a[d]===b&&a.splice(d,1)},n.ctor=function(a){return function(){var b=Object.create(a.prototype);return a.apply(b,arguments),b}},n.Math={},n.Math.clamp=function(a,b,c){return Math.min(Math.max(c,a),b)};var p=n.Vec3={};p.create=function(a){a=a||1;var b="number"==typeof a;return new Float32Array(b?3*a:a)},p.set=function(a,b,c,d,e){var f=3*b,g=f+1,h=f+2;null==d&&(e=c[2],d=c[1],c=c[0]),a[f]=c,a[g]=d,a[h]=e},p.copy=function(a,b,c){var d=3*b,e=d+1,f=d+2;return c[0]=a[d],c[1]=a[e],c[2]=a[f],c},p.lengthSq=function(a,b){var c=3*b,d=c+1,e=c+2,f=a[c],g=a[d],h=a[e];return f*f+g*g+h*h},p.length=function(a,b){var c=3*b,d=c+1,e=c+2,f=a[c],g=a[d],h=a[e];return Math.sqrt(f*f+g*g+h*h)},p.distanceSq=function(a,b,c){var d=3*b,e=d+1,f=d+2,g=3*c,h=g+1,i=g+2,j=a[d]-a[g],k=a[e]-a[h],l=a[f]-a[i];return j*j+k*k+l*l},p.distance=function(a,b,c){var d=3*b,e=d+1,f=d+2,g=3*c,h=g+1,i=g+2,j=a[d]-a[g],k=a[e]-a[h],l=a[f]-a[i];return Math.sqrt(j*j+k*k+l*l)},p.normalize=function(a,b){var c=3*b,d=c+1,e=c+2,f=a[c],g=a[d],h=a[e],i=1/Math.sqrt(f*f+g*g+h*h);a[c]*=i,a[d]*=i,a[e]*=i},p.angle=function(a,b,c,d){var e=3*b,f=e+1,g=e+2,h=3*c,i=h+1,j=h+2,k=3*d,l=k+1,m=k+2,n=1/p.distance(a,c,b),o=1/p.distance(a,c,d),q=(a[e]-a[h])*n,r=(a[f]-a[i])*n,s=(a[g]-a[j])*n,t=(a[k]-a[h])*o,u=(a[l]-a[i])*o,v=(a[m]-a[j])*o,w=q*t+r*u+s*v;return Math.acos(w)},n.Force=a,a.create=n.ctor(a),a.ATTRACTOR=0,a.REPULSOR=1,a.ATTRACTOR_REPULSOR=2,a.prototype.type=a.ATTRACTOR,a.prototype.set=function(a,b,c){n.Vec3.set(this.vector,0,a,b,c)},a.prototype.applyForce=function(a,b,c,d){},n.DirectionalForce=b,b.create=n.ctor(b),b.prototype=Object.create(n.Force.prototype),b.prototype.constructor=b,b.prototype.applyForce=function(a,b,c,d){var e=this.vector;b[a]+=e[0],b[a+1]+=e[1],b[a+2]+=e[2]},n.PointForce=c;var q=n.Force.ATTRACTOR,r=n.Force.REPULSOR,s=n.Force.ATTRACTOR_REPULSOR;return c.create=n.ctor(c),c.prototype=Object.create(n.Force.prototype),c.prototype.constructor=c,c.prototype.setRadius=function(a){this._radius2=a*a},c.prototype._radius2=null,c.prototype.applyForce=function(a,b,c,d){var e,f,g=this.vector,h=a+1,i=a+2,j=c[a]-g[0],k=c[h]-g[1],l=c[i]-g[2],m=j*j+k*k+l*l,n=m-this._radius2;switch(this.type){case q:e=m>0&&n>0;break;case r:e=m>0&&0>n;break;case s:e=j||k||l}e&&(f=n/m*this.intensity,b[a]-=j*f,b[h]-=k*f,b[i]-=l*f)},n.Constraint=d,d.create=n.ctor(d),d.prototype.setIndices=function(a){for(var b=this._offset,c=a.length?a:arguments,d=this.indices,e=0;e<c.length;e++)d[e+b]=c[e]},d.prototype.applyConstraint=function(a,b,c){},n.AngleConstraint=e,e.create=n.ctor(e),e.prototype=Object.create(n.Constraint.prototype),e.prototype.constructor=e,e.prototype.setAngle=function(a,b){b=null!=b?b:a,this.setMin(a),this.setMax(b)},e.prototype.setMin=function(a){this._min=this.clampAngle(a)},e.prototype._min=null,e.prototype.setMax=function(a){this._max=this.clampAngle(a)},e.prototype._max=null,e.prototype.clampAngle=function(a){var b=1e-7;return n.Math.clamp(b,Math.PI-b,a)},e.ANGLE_OBTUSE=.75*Math.PI,e.prototype.applyConstraint=function(a,b,c){var d=this.indices,f=d[a],g=d[a+1],h=d[a+2],i=3*f,j=i+1,k=i+2,l=3*g,m=l+1,n=l+2,o=3*h,p=o+1,q=o+2,r=b[l]-b[i],s=b[m]-b[j],t=b[n]-b[k],u=b[o]-b[l],v=b[p]-b[m],w=b[q]-b[n],x=b[o]-b[i],y=b[p]-b[j],z=b[q]-b[k];if(!(x||y||z))return b[i]+=.1,b[m]+=.1,void(b[o]-=.1);var A=r*r+s*s+t*t,B=u*u+v*v+w*w,C=x*x+y*y+z*z,D=Math.sqrt(A),E=Math.sqrt(B),F=Math.sqrt(C),G=1/D,H=1/E,I=this._min,J=this._max,K=Math.acos(-r*G*u*H+-s*G*v*H+-t*G*w*H);if(!(K>I&&J>K)){var L=I>K?I:J,M=A+B-2*D*E*Math.cos(L),N=Math.sqrt(M),O=(F-N)/F*.5;if(b[i]+=x*O,b[j]+=y*O,b[k]+=z*O,b[o]-=x*O,b[p]-=y*O,b[q]-=z*O,!(L<e.ANGLE_OBTUSE)){var P=Math.acos((A+M-B)/(2*D*N)),Q=1/F,R=x*Q,S=y*Q,T=z*Q,U=R*r+S*s+T*t,V=R*U,W=S*U,X=T*U,Y=V-r,Z=W-s,$=X-t;if(!(Y||Z||$))return void(L<Math.PI&&(b[l]+=.1,b[m]+=.1,b[n]+=.1));var _=V*V+W*W+X*X,aa=Y*Y+Z*Z+$*$,ba=Math.sqrt(_),ca=Math.sqrt(aa),da=ba*Math.tan(P),ea=(ca-da)/ca;b[l]+=Y*ea,b[m]+=Z*ea,b[n]+=$*ea}}},n.AxisConstraint=f,f.create=n.ctor(f),f.prototype=Object.create(n.Constraint.prototype),f.prototype.constructor=f,f.prototype.setAxis=function(a,b){var c=this.indices;c[0]=a,c[1]=b},f.prototype.applyConstraint=function(a,b,c){var d=this.indices,e=d[0],f=d[a+2],g=d[1],h=3*e,i=h+1,j=h+2,k=3*f,l=k+1,m=k+2,n=3*g,o=n+1,p=n+2,q=b[k]-b[h],r=b[l]-b[i],s=b[m]-b[j],t=b[n]-b[h],u=b[o]-b[i],v=b[p]-b[j],w=t*t+u*u+v*v,x=Math.sqrt(w),y=1/x,z=t*y,A=u*y,B=v*y,C=z*q+A*r+B*s,D=z*C,E=A*C,F=B*C;b[k]=b[h]+D,b[l]=b[i]+E,b[m]=b[j]+F},n.BoundingPlaneConstraint=g,g.create=n.ctor(g),g.prototype=Object.create(n.Constraint.prototype),g.prototype.constructor=g,g.prototype._isGlobal=!0,g.prototype.setOrigin=function(a,b,c){n.Vec3.set(this.bufferVec3,0,a,b,c)},g.prototype.setNormal=function(a,b,c){n.Vec3.set(this.bufferVec3,1,a,b,c),n.Vec3.normalize(this.bufferVec3,1)},g.prototype.applyConstraint=function(a,b,c){var d=this.friction,e=this.bufferVec3,f=a,g=f+1,h=f+2,i=b[f]-e[0],j=b[g]-e[1],k=b[h]-e[2],l=e[3],m=e[4],n=e[5],o=i*l+j*m+k*n;o>this.distance||(b[f]-=l*o,b[g]-=m*o,b[h]-=n*o,c[f]-=(c[f]-b[f])*d,c[g]-=(c[g]-b[g])*d,c[h]-=(c[h]-b[h])*d)},n.BoxConstraint=h,h.create=n.ctor(h),h.prototype=Object.create(n.Constraint.prototype),h.prototype.constructor=h,h.prototype._isGlobal=!0,h.prototype.setBounds=function(a,b){this.setMin(a),this.setMax(b)},h.prototype.setMin=function(a,b,c){n.Vec3.set(this.bufferVec3,0,a,b,c)},h.prototype.setMax=function(a,b,c){n.Vec3.set(this.bufferVec3,1,a,b,c)},h.prototype.applyConstraint=function(a,b,c){var d=this.friction,e=this.bufferVec3,f=a,g=f+1,h=f+2,i=n.Math.clamp(e[0],e[3],b[f]),j=n.Math.clamp(e[1],e[4],b[g]),k=n.Math.clamp(e[2],e[5],b[h]),l=b[f]-i,m=b[g]-j,o=b[h]-k;b[f]=i,b[g]=j,b[h]=k,(l||m||o)&&(c[f]-=(c[f]-i)*d,c[g]-=(c[g]-j)*d,c[h]-=(c[h]-k)*d)},n.DistanceConstraint=i,i.create=n.ctor(i),i.prototype=Object.create(n.Constraint.prototype),i.prototype.constructor=i,i.prototype.setDistance=function(a,b){this.setMin(a),this.setMax(null!=b?b:a)},i.prototype.setMin=function(a){this._min2=a*a},i.prototype._min2=null,i.prototype.setMax=function(a){this._max2=a*a},i.prototype._max2=null,i.prototype.applyConstraint=function(a,b,c){var d=this.indices,e=d[a],f=d[a+1],g=3*e,h=g+1,i=g+2,j=3*f,k=j+1,l=j+2,m=b[j]-b[g],n=b[k]-b[h],o=b[l]-b[i];m||n||o||(m=n=o=.1);var p=m*m+n*n+o*o,q=this._min2,r=this._max2;if(!(r>p&&p>q)){var s=q>p?q:r,t=s/(p+s),u=t-.5,v=t-.5;b[g]-=m*u,b[h]-=n*u,b[i]-=o*u,b[j]+=m*v,b[k]+=n*v,b[l]+=o*v}},n.PlaneConstraint=j,j.create=n.ctor(j),j.prototype=Object.create(n.Constraint.prototype),j.prototype.constructor=j,j.prototype.setPlane=function(a,b,c){var d=this.indices;d[0]=a,d[1]=b,d[2]=c},j.prototype._calculateNormal=function(a,b){var c=this.bufferVec3,d=this.indices,e=d[0],f=d[1],g=d[2],h=3*e,i=h+1,j=h+2,k=3*f,l=k+1,m=k+2,n=3*g,o=n+1,p=n+2,q=b[h]-b[k],r=b[i]-b[l],s=b[j]-b[m],t=b[n]-b[k],u=b[o]-b[l],v=b[p]-b[m],w=r*v-s*u,x=s*t-q*v,y=q*u-r*t,z=w*w+x*x+y*y;if(!z)return b[h]+=.1,b[l]+=.1,b[n]-=.1,void(this._hasNormal=!1);var A=1/Math.sqrt(z);c[0]=w*A,c[1]=x*A,c[2]=y*A,this._hasNormal=!0},j.prototype._hasNormal=!1,j.prototype.applyConstraint=function(a,b,c){var d=this.bufferVec3,e=this.indices,f=e[1],g=e[a+3],h=3*f,i=h+1,j=h+2,k=3*g,l=k+1,m=k+2;if(0===a&&this._calculateNormal(a,b),this._hasNormal){var n=d[0],o=d[1],p=d[2],q=b[k]-b[h],r=b[l]-b[i],s=b[m]-b[j],t=q*n+r*o+s*p;b[k]-=n*t,b[l]-=o*t,b[m]-=p*t}},n.PointConstraint=k,k.create=n.ctor(k),k.prototype=Object.create(n.Constraint.prototype),k.prototype.constructor=k,k.prototype.setPosition=function(a,b,c){n.Vec3.set(this.bufferVec3,0,a,b,c)},k.prototype.applyConstraint=function(a,b,c){var d=this.bufferVec3,e=this.indices[a],f=3*e,g=f+1,h=f+2;b[f]=c[f]=d[0],b[g]=c[g]=d[1],b[h]=c[h]=d[2]},n.ParticleSystem=l,l.create=n.ctor(l),l.prototype.constructor=l,l.prototype.setPosition=function(a,b,c,d){n.Vec3.set(this.positions,a,b,c,d),n.Vec3.set(this.positionsPrev,a,b,c,d)},l.prototype.getPosition=function(a,b){return n.Vec3.copy(this.positions,a,b)},l.prototype.getDistance=function(a,b){return n.Vec3.distance(this.positions,a,b)},l.prototype.getAngle=function(a,b,c){return n.Vec3.angle(this.positions,a,b,c)},l.prototype.setWeight=function(a,b){this.weights[a]=b},l.prototype.setWeights=function(a){for(var b=this.weights,c=0,d=b.length;d>c;c++)b[c]=a},l.prototype.each=function(a,b){b=b||this;for(var c=0,d=this._count;d>c;c++)a.call(b,c,this)},l.prototype.perturb=function(a){for(var b,c=this.positions,d=this.positionsPrev,e=0,f=c.length;f>e;e++)b=Math.random()*a,c[e]+=b,d[e]+=b},l.prototype.integrate=function(a){for(var b,c,d=a*a,e=this.positions,f=this.positionsPrev,g=this.accumulatedForces,h=this.weights,i=0,j=this._count;j>i;i++)c=h[i],b=3*i,m(b,e,f,g,c,d),m(b+1,e,f,g,c,d),m(b+2,e,f,g,c,d)},l.prototype._getConstraintBuffer=function(a){return a._isGlobal?this._globalConstraints:this._localConstraints},l.prototype.addConstraint=function(a){this._getConstraintBuffer(a).push(a)},l.prototype.removeConstraint=function(a){n.Collection.removeAll(this._getConstraintBuffer(a),a)},l.prototype.addPinConstraint=function(a){this._pinConstraints.push(a)},l.prototype.removePinConstraint=function(a){n.Collection.removeAll(this._pinConstraints,a)},l.prototype.satisfyConstraints=function(){for(var a=this._iterations,b=this._globalConstraints,c=this._localConstraints,d=this._pinConstraints,e=this._count,f=3,g=0;a>g;g++)this.satisfyConstraintGroup(b,e,f),this.satisfyConstraintGroup(c),d.length&&this.satisfyConstraintGroup(d)},l.prototype.satisfyConstraintGroup=function(a,b,c){for(var d,e=this.positions,f=this.positionsPrev,g=!b,h=0,i=a.length;i>h;h++){d=a[h],g&&(b=d._count,c=d._itemSize);for(var j=0;b>j;j++)d.applyConstraint(j*c,e,f)}},l.prototype.addForce=function(a){this._forces.push(a)},l.prototype.removeForce=function(a){n.Collection.removeAll(this._forces,a)},l.prototype.accumulateForces=function(a){for(var b,c=this._forces,d=this.accumulatedForces,e=this.positions,f=this.positionsPrev,g=0,h=this._count;h>g;g++){b=3*g,d[b]=d[b+1]=d[b+2]=0;for(var i=0,j=c.length;j>i;i++)c[i].applyForce(b,d,e,f)}},l.prototype.tick=function(a){this.accumulateForces(a),this.integrate(a),this.satisfyConstraints()},n}),function(a){function b(a,b,c){this.x=a,this.y=b,this.z=c}function c(a){return a*a*a*(a*(6*a-15)+10)}function d(a,b,c){return(1-c)*a+c*b}var e=a.noise={};b.prototype.dot2=function(a,b){return this.x*a+this.y*b},b.prototype.dot3=function(a,b,c){return this.x*a+this.y*b+this.z*c};var f=[new b(1,1,0),new b(-1,1,0),new b(1,-1,0),new b(-1,-1,0),new b(1,0,1),new b(-1,0,1),new b(1,0,-1),new b(-1,0,-1),new b(0,1,1),new b(0,-1,1),new b(0,1,-1),new b(0,-1,-1)],g=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],h=new Array(512),i=new Array(512);e.seed=function(a){a>0&&1>a&&(a*=65536),a=Math.floor(a),256>a&&(a|=a<<8);for(var b=0;256>b;b++){var c;c=1&b?g[b]^255&a:g[b]^a>>8&255,h[b]=h[b+256]=c,i[b]=i[b+256]=f[c%12]}},e.seed(0);var j=.5*(Math.sqrt(3)-1),k=(3-Math.sqrt(3))/6,l=1/3,m=1/6;e.simplex2=function(a,b){var c,d,e,f,g,l=(a+b)*j,m=Math.floor(a+l),n=Math.floor(b+l),o=(m+n)*k,p=a-m+o,q=b-n+o;p>q?(f=1,g=0):(f=0,g=1);var r=p-f+k,s=q-g+k,t=p-1+2*k,u=q-1+2*k;m&=255,n&=255;var v=i[m+h[n]],w=i[m+f+h[n+g]],x=i[m+1+h[n+1]],y=.5-p*p-q*q;0>y?c=0:(y*=y,c=y*y*v.dot2(p,q));var z=.5-r*r-s*s;0>z?d=0:(z*=z,d=z*z*w.dot2(r,s));var A=.5-t*t-u*u;return 0>A?e=0:(A*=A,e=A*A*x.dot2(t,u)),70*(c+d+e)},e.simplex3=function(a,b,c){var d,e,f,g,j,k,n,o,p,q,r=(a+b+c)*l,s=Math.floor(a+r),t=Math.floor(b+r),u=Math.floor(c+r),v=(s+t+u)*m,w=a-s+v,x=b-t+v,y=c-u+v;w>=x?x>=y?(j=1,k=0,n=0,o=1,p=1,q=0):w>=y?(j=1,k=0,n=0,o=1,p=0,q=1):(j=0,k=0,n=1,o=1,p=0,q=1):y>x?(j=0,k=0,n=1,o=0,p=1,q=1):y>w?(j=0,k=1,n=0,o=0,p=1,q=1):(j=0,k=1,n=0,o=1,p=1,q=0);var z=w-j+m,A=x-k+m,B=y-n+m,C=w-o+2*m,D=x-p+2*m,E=y-q+2*m,F=w-1+3*m,G=x-1+3*m,H=y-1+3*m;s&=255,t&=255,u&=255;var I=i[s+h[t+h[u]]],J=i[s+j+h[t+k+h[u+n]]],K=i[s+o+h[t+p+h[u+q]]],L=i[s+1+h[t+1+h[u+1]]],M=.6-w*w-x*x-y*y;0>M?d=0:(M*=M,d=M*M*I.dot3(w,x,y));var N=.6-z*z-A*A-B*B;0>N?e=0:(N*=N,e=N*N*J.dot3(z,A,B));var O=.6-C*C-D*D-E*E;0>O?f=0:(O*=O,f=O*O*K.dot3(C,D,E));var P=.6-F*F-G*G-H*H;return 0>P?g=0:(P*=P,g=P*P*L.dot3(F,G,H)),32*(d+e+f+g)},e.perlin2=function(a,b){var e=Math.floor(a),f=Math.floor(b);a-=e,b-=f,e=255&e,f=255&f;var g=i[e+h[f]].dot2(a,b),j=i[e+h[f+1]].dot2(a,b-1),k=i[e+1+h[f]].dot2(a-1,b),l=i[e+1+h[f+1]].dot2(a-1,b-1),m=c(a);return d(d(g,k,m),d(j,l,m),c(b))},e.perlin3=function(a,b,e){var f=Math.floor(a),g=Math.floor(b),j=Math.floor(e);a-=f,b-=g,e-=j,f=255&f,g=255&g,j=255&j;var k=i[f+h[g+h[j]]].dot3(a,b,e),l=i[f+h[g+h[j+1]]].dot3(a,b,e-1),m=i[f+h[g+1+h[j]]].dot3(a,b-1,e),n=i[f+h[g+1+h[j+1]]].dot3(a,b-1,e-1),o=i[f+1+h[g+h[j]]].dot3(a-1,b,e),p=i[f+1+h[g+h[j+1]]].dot3(a-1,b,e-1),q=i[f+1+h[g+1+h[j]]].dot3(a-1,b-1,e),r=i[f+1+h[g+1+h[j+1]]].dot3(a-1,b-1,e-1),s=c(a),t=c(b),u=c(e);return d(d(d(k,o,s),d(l,p,s),u),d(d(m,q,s),d(n,r,s),u),t)}}(this),function(){var a={},b=null,c=!0,d=!1;try{"undefined"!=typeof AudioContext?b=new AudioContext:"undefined"!=typeof webkitAudioContext?b=new webkitAudioContext:c=!1}catch(e){c=!1}if(!c)if("undefined"!=typeof Audio)try{new Audio}catch(e){d=!0}else d=!0;if(c){var f="undefined"==typeof b.createGain?b.createGainNode():b.createGain();f.gain.value=1,f.connect(b.destination)}var g=function(a){this._volume=1,this._muted=!1,this.usingWebAudio=c,this.ctx=b,this.noAudio=d,this._howls=[],this._codecs=a,this.iOSAutoEnable=!0};g.prototype={volume:function(a){var b=this;if(a=parseFloat(a),a>=0&&1>=a){b._volume=a,c&&(f.gain.value=a);for(var d in b._howls)if(b._howls.hasOwnProperty(d)&&b._howls[d]._webAudio===!1)for(var e=0;e<b._howls[d]._audioNode.length;e++)b._howls[d]._audioNode[e].volume=b._howls[d]._volume*b._volume;return b}return c?f.gain.value:b._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){var b=this;b._muted=a,c&&(f.gain.value=a?0:b._volume);for(var d in b._howls)if(b._howls.hasOwnProperty(d)&&b._howls[d]._webAudio===!1)for(var e=0;e<b._howls[d]._audioNode.length;e++)b._howls[d]._audioNode[e].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!b||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var c=function(){var d=b.createBuffer(1,1,22050),e=b.createBufferSource();e.buffer=d,e.connect(b.destination),"undefined"==typeof e.start?e.noteOn(0):e.start(0),setTimeout(function(){(e.playbackState===e.PLAYING_STATE||e.playbackState===e.FINISHED_STATE)&&(a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchstart",c,!1))},0)};return window.addEventListener("touchstart",c,!1),a}}};var h=null,i={};d||(h=new Audio,i={mp3:!!h.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!h.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var j=new g(i),k=function(a){var d=this;d._autoplay=a.autoplay||!1,d._buffer=a.buffer||!1,d._duration=a.duration||0,d._format=a.format||null,d._loop=a.loop||!1,d._loaded=!1,d._sprite=a.sprite||{},d._src=a.src||"",d._pos3d=a.pos3d||[0,0,-.5],d._volume=void 0!==a.volume?a.volume:1,d._urls=a.urls||[],d._rate=a.rate||1,d._model=a.model||null,d._onload=[a.onload||function(){}],d._onloaderror=[a.onloaderror||function(){}],d._onend=[a.onend||function(){}],d._onpause=[a.onpause||function(){}],d._onplay=[a.onplay||function(){}],d._onendTimer=[],d._webAudio=c&&!d._buffer,d._audioNode=[],d._webAudio&&d._setupAudioNode(),"undefined"!=typeof b&&b&&j.iOSAutoEnable&&j._enableiOSAudio(),j._howls.push(d),d.load()};if(k.prototype={load:function(){var a=this,b=null;if(d)return void a.on("loaderror");for(var c=0;c<a._urls.length;c++){var e,f;if(a._format)e=a._format;else{if(f=a._urls[c],e=/^data:audio\/([^;,]+);/i.exec(f),e||(e=/\.([^.]+)$/.exec(f.split("?",1)[0])),!e)return void a.on("loaderror");e=e[1].toLowerCase()}if(i[e]){b=a._urls[c];break}}if(!b)return void a.on("loaderror");if(a._src=b,a._webAudio)l(a,b);else{var h=new Audio;h.addEventListener("error",function(){h.error&&4===h.error.code&&(g.noAudio=!0),a.on("loaderror",{type:h.error?h.error.code:0})},!1),a._audioNode.push(h),h.src=b,h._pos=0,h.preload="auto",h.volume=j._muted?0:a._volume*j.volume();var k=function(){a._duration=Math.ceil(10*h.duration)/10,0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1e3*a._duration]}),a._loaded||(a._loaded=!0,a.on("load")),a._autoplay&&a.play(),h.removeEventListener("canplaythrough",k,!1)};h.addEventListener("canplaythrough",k,!1),h.load()}return a},urls:function(a){var b=this;return a?(b.stop(),b._urls="string"==typeof a?[a]:a,b._loaded=!1,b.load(),b):b._urls},play:function(a,c){var d=this;return"function"==typeof a&&(c=a),a&&"function"!=typeof a||(a="_default"),d._loaded?d._sprite[a]?(d._inactiveNode(function(e){e._sprite=a;var f=e._pos>0?e._pos:d._sprite[a][0]/1e3,g=0;d._webAudio?(g=d._sprite[a][1]/1e3-e._pos,e._pos>0&&(f=d._sprite[a][0]/1e3+f)):g=d._sprite[a][1]/1e3-(f-d._sprite[a][0]/1e3);var h,i=!(!d._loop&&!d._sprite[a][2]),k="string"==typeof c?c:Math.round(Date.now()*Math.random())+"";if(function(){var b={id:k,sprite:a,loop:i};h=setTimeout(function(){!d._webAudio&&i&&d.stop(b.id).play(a,b.id),d._webAudio&&!i&&(d._nodeById(b.id).paused=!0,d._nodeById(b.id)._pos=0,d._clearEndTimer(b.id)),d._webAudio||i||d.stop(b.id),d.on("end",k)},1e3*g),d._onendTimer.push({timer:h,id:b.id})}(),d._webAudio){var l=d._sprite[a][0]/1e3,m=d._sprite[a][1]/1e3;e.id=k,e.paused=!1,o(d,[i,l,m],k),d._playStart=b.currentTime,e.gain.value=d._volume,"undefined"==typeof e.bufferSource.start?e.bufferSource.noteGrainOn(0,f,g):e.bufferSource.start(0,f,g)}else{if(4!==e.readyState&&(e.readyState||!navigator.isCocoonJS))return d._clearEndTimer(k),function(){var b=d,f=a,g=c,h=e,i=function(){b.play(f,g),h.removeEventListener("canplaythrough",i,!1)};h.addEventListener("canplaythrough",i,!1)}(),d;e.readyState=4,e.id=k,e.currentTime=f,e.muted=j._muted||e.muted,e.volume=d._volume*j.volume(),setTimeout(function(){e.play()},0)}return d.on("play"),"function"==typeof c&&c(k),d}),d):("function"==typeof c&&c(),d):(d.on("load",function(){d.play(a,c)}),d)},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,a),b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0,"undefined"==typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();return b.on("pause"),b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0,"undefined"==typeof c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||(c.pause(),c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=0:c.muted=!0),b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1),b},volume:function(a,b){var c=this;if(a=parseFloat(a),a>=0&&1>=a){if(c._volume=a,!c._loaded)return c.on("play",function(){c.volume(a,b)}),c;var d=b?c._nodeById(b):c._activeNode();return d&&(c._webAudio?d.gain.value=a:d.volume=a*j.volume()),c}return c._volume},loop:function(a){var b=this;return"boolean"==typeof a?(b._loop=a,b):b._loop},sprite:function(a){var b=this;return"object"==typeof a?(b._sprite=a,b):b._sprite},pos:function(a,c){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"==typeof a?d:d._pos||0;a=parseFloat(a);var e=c?d._nodeById(c):d._activeNode();if(e)return a>=0?(d.pause(c),e._pos=a,d.play(e._sprite,c),d):d._webAudio?e._pos+(b.currentTime-d._playStart):e.currentTime;if(a>=0)return d;for(var f=0;f<d._audioNode.length;f++)if(d._audioNode[f].paused&&4===d._audioNode[f].readyState)return d._webAudio?d._audioNode[f]._pos:d._audioNode[f].currentTime},pos3d:function(a,b,c,d){var e=this;if(b="undefined"!=typeof b&&b?b:0,c="undefined"!=typeof c&&c?c:-.5,!e._loaded)return e.on("play",function(){e.pos3d(a,b,c,d)}),e;if(!(a>=0||0>a))return e._pos3d;if(e._webAudio){var f=d?e._nodeById(d):e._activeNode();f&&(e._pos3d=[a,b,c],f.panner.setPosition(a,b,c),f.panner.panningModel=e._model||"HRTF")}return e},fade:function(a,b,c,d,e){var f=this,g=Math.abs(a-b),h=a>b?"down":"up",i=g/.01,j=c/i;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var k=1;i>=k;k++)!function(){var a=f._volume+("up"===h?.01:-.01)*k,c=Math.round(1e3*a)/1e3,g=b;setTimeout(function(){f.volume(c,e),c===g&&d&&d()},j*k)}()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},fadeOut:function(a,b,c,d){var e=this;return e.fade(e._volume,a,b,function(){c&&c(),e.pause(d),e.on("end")},d)},_nodeById:function(a){for(var b=this,c=b._audioNode[0],d=0;d<b._audioNode.length;d++)if(b._audioNode[d].id===a){c=b._audioNode[d];break}return c},_activeNode:function(){for(var a=this,b=null,c=0;c<a._audioNode.length;c++)if(!a._audioNode[c].paused){b=a._audioNode[c];break}return a._drainPool(),b},_inactiveNode:function(a){for(var b=this,c=null,d=0;d<b._audioNode.length;d++)if(b._audioNode[d].paused&&4===b._audioNode[d].readyState){a(b._audioNode[d]),c=!0;break}if(b._drainPool(),!c){var e;if(b._webAudio)e=b._setupAudioNode(),a(e);else{b.load(),e=b._audioNode[b._audioNode.length-1];var f=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",g=function(){e.removeEventListener(f,g,!1),a(e)};e.addEventListener(f,g,!1)}}},_drainPool:function(){var a,b=this,c=0;for(a=0;a<b._audioNode.length;a++)b._audioNode[a].paused&&c++;for(a=b._audioNode.length-1;a>=0&&!(5>=c);a--)b._audioNode[a].paused&&(b._webAudio&&b._audioNode[a].disconnect(0),c--,b._audioNode.splice(a,1))},_clearEndTimer:function(a){for(var b=this,c=0,d=0;d<b._onendTimer.length;d++)if(b._onendTimer[d].id===a){c=d;break}var e=b._onendTimer[c];e&&(clearTimeout(e.timer),b._onendTimer.splice(c,1))},_setupAudioNode:function(){var a=this,c=a._audioNode,d=a._audioNode.length;return c[d]="undefined"==typeof b.createGain?b.createGainNode():b.createGain(),c[d].gain.value=a._volume,c[d].paused=!0,c[d]._pos=0,c[d].readyState=4,c[d].connect(f),c[d].panner=b.createPanner(),c[d].panner.panningModel=a._model||"equalpower",c[d].panner.setPosition(a._pos3d[0],a._pos3d[1],a._pos3d[2]),c[d].panner.connect(c[d]),c[d]},on:function(a,b){var c=this,d=c["_on"+a];if("function"==typeof b)d.push(b);else for(var e=0;e<d.length;e++)b?d[e].call(c,b):d[e].call(c);return c},off:function(a,b){var c=this,d=c["_on"+a],e=b?b.toString():null;if(e){for(var f=0;f<d.length;f++)if(e===d[f].toString()){d.splice(f,1);break}}else c["_on"+a]=[];return c},unload:function(){for(var b=this,c=b._audioNode,d=0;d<b._audioNode.length;d++)c[d].paused||(b.stop(c[d].id),b.on("end",c[d].id)),b._webAudio?c[d].disconnect(0):c[d].src="";for(d=0;d<b._onendTimer.length;d++)clearTimeout(b._onendTimer[d].timer);

var e=j._howls.indexOf(b);null!==e&&e>=0&&j._howls.splice(e,1),delete a[b._src],b=null}},c)var l=function(b,c){if(c in a)return b._duration=a[c].duration,void n(b);if(/^data:[^;]+;base64,/.test(c)){for(var d=atob(c.split(",")[1]),e=new Uint8Array(d.length),f=0;f<d.length;++f)e[f]=d.charCodeAt(f);m(e.buffer,b,c)}else{var g=new XMLHttpRequest;g.open("GET",c,!0),g.responseType="arraybuffer",g.onload=function(){m(g.response,b,c)},g.onerror=function(){b._webAudio&&(b._buffer=!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,delete a[c],b.load())};try{g.send()}catch(h){g.onerror()}}},m=function(c,d,e){b.decodeAudioData(c,function(b){b&&(a[e]=b,n(d,b))},function(a){d.on("loaderror")})},n=function(a,b){a._duration=b?b.duration:a._duration,0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1e3*a._duration]}),a._loaded||(a._loaded=!0,a.on("load")),a._autoplay&&a.play()},o=function(c,d,e){var f=c._nodeById(e);f.bufferSource=b.createBufferSource(),f.bufferSource.buffer=a[c._src],f.bufferSource.connect(f.panner),f.bufferSource.loop=d[0],d[0]&&(f.bufferSource.loopStart=d[1],f.bufferSource.loopEnd=d[1]+d[2]),f.bufferSource.playbackRate.value=c._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:j,Howl:k}}),"undefined"!=typeof exports&&(exports.Howler=j,exports.Howl=k),"undefined"!=typeof window&&(window.Howler=j,window.Howl=k)}(),THREE.TrackballControls=function(a,b){function c(a){l.enabled!==!1&&(window.removeEventListener("keydown",c),p=o,o===m.NONE&&(a.keyCode!==l.keys[m.ROTATE]||l.noRotate?a.keyCode!==l.keys[m.ZOOM]||l.noZoom?a.keyCode!==l.keys[m.PAN]||l.noPan||(o=m.PAN):o=m.ZOOM:o=m.ROTATE))}function d(a){l.enabled!==!1&&(o=p,window.addEventListener("keydown",c,!1))}function e(a){l.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),o===m.NONE&&(o=a.button),o!==m.ROTATE||l.noRotate?o!==m.ZOOM||l.noZoom?o!==m.PAN||l.noPan||(l.getMouseOnScreen(a.pageX,a.pageY,x),y.copy(x)):(l.getMouseOnScreen(a.pageX,a.pageY,t),u.copy(t)):(l.getMouseProjectionOnBall(a.pageX,a.pageY,r),s.copy(r)),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",g,!1),l.dispatchEvent(A))}function f(a){l.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),o!==m.ROTATE||l.noRotate?o!==m.ZOOM||l.noZoom?o!==m.PAN||l.noPan||l.getMouseOnScreen(a.pageX,a.pageY,y):l.getMouseOnScreen(a.pageX,a.pageY,u):l.getMouseProjectionOnBall(a.pageX,a.pageY,s))}function g(a){l.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),o=m.NONE,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),l.dispatchEvent(B))}function h(a){if(l.enabled!==!1){a.preventDefault(),a.stopPropagation();var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail/3),t.y+=.01*b,l.dispatchEvent(A),l.dispatchEvent(B)}}function i(a){if(l.enabled!==!1){switch(a.touches.length){case 1:o=m.TOUCH_ROTATE,s.copy(l.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY,r));break;case 2:o=m.TOUCH_ZOOM;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;w=v=Math.sqrt(b*b+c*c);break;case 3:o=m.TOUCH_PAN,y.copy(l.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY,x));break;default:o=m.NONE}l.dispatchEvent(A)}}function j(a){if(l.enabled!==!1)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:l.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY,s);break;case 2:var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;w=Math.sqrt(b*b+c*c);break;case 3:l.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY,y);break;default:o=m.NONE}}function k(a){if(l.enabled!==!1){switch(a.touches.length){case 1:r.copy(l.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY,s));break;case 2:v=w=0;break;case 3:x.copy(l.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY,y))}o=m.NONE,l.dispatchEvent(B)}}var l=this,m={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var n=new THREE.Vector3,o=m.NONE,p=m.NONE,q=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Vector2,u=new THREE.Vector2,v=0,w=0,x=new THREE.Vector2,y=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var z={type:"change"},A={type:"start"},B={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{this.screen=this.domElement.getBoundingClientRect();var a=this.domElement.ownerDocument.documentElement;this.screen.left+=window.pageXOffset-a.clientLeft,this.screen.top+=window.pageYOffset-a.clientTop}},this.handleEvent=function(a){"function"==typeof this[a.type]&&this[a.type](a)},this.getMouseOnScreen=function(a,b,c){return c.set((a-l.screen.left)/l.screen.width,(b-l.screen.top)/l.screen.height)},this.getMouseProjectionOnBall=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){b.set((c-.5*l.screen.width-l.screen.left)/(.5*l.screen.width),(.5*l.screen.height+l.screen.top-d)/(.5*l.screen.height),0);var f=b.length();return l.noRoll?f<Math.SQRT1_2?b.z=Math.sqrt(1-f*f):b.z=.5/f:f>1?b.normalize():b.z=Math.sqrt(1-f*f),q.copy(l.object.position).sub(l.target),e.copy(l.object.up).setLength(b.y),e.add(a.copy(l.object.up).cross(q).setLength(b.x)),e.add(q.setLength(b.z)),e}}(),this.rotateCamera=function(){var a=new THREE.Vector3,b=new THREE.Quaternion;return function(){var c=Math.acos(r.dot(s)/r.length()/s.length());c&&(a.crossVectors(r,s).normalize(),c*=l.rotateSpeed,b.setFromAxisAngle(a,-c),q.applyQuaternion(b),l.object.up.applyQuaternion(b),s.applyQuaternion(b),l.staticMoving?r.copy(s):(b.setFromAxisAngle(a,c*(l.dynamicDampingFactor-1)),r.applyQuaternion(b)))}}(),this.zoomCamera=function(){if(o===m.TOUCH_ZOOM){var a=v/w;v=w,q.multiplyScalar(a)}else{var a=1+(u.y-t.y)*l.zoomSpeed;1!==a&&a>0&&(q.multiplyScalar(a),l.staticMoving?t.copy(u):t.y+=(u.y-t.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var a=new THREE.Vector2,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.copy(y).sub(x),a.lengthSq()&&(a.multiplyScalar(q.length()*l.panSpeed),c.copy(q).cross(l.object.up).setLength(a.x),c.add(b.copy(l.object.up).setLength(a.y)),l.object.position.add(c),l.target.add(c),l.staticMoving?x.copy(y):x.add(a.subVectors(y,x).multiplyScalar(l.dynamicDampingFactor)))}}(),this.checkDistances=function(){l.noZoom&&l.noPan||(q.lengthSq()>l.maxDistance*l.maxDistance&&l.object.position.addVectors(l.target,q.setLength(l.maxDistance)),q.lengthSq()<l.minDistance*l.minDistance&&l.object.position.addVectors(l.target,q.setLength(l.minDistance)))},this.update=function(){q.subVectors(l.object.position,l.target),l.noRotate||l.rotateCamera(),l.noZoom||l.zoomCamera(),l.noPan||l.panCamera(),l.object.position.addVectors(l.target,q),l.checkDistances(),l.object.lookAt(l.target),n.distanceToSquared(l.object.position)>0&&(l.dispatchEvent(z),n.copy(l.object.position))},this.reset=function(){o=m.NONE,p=m.NONE,l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.up.copy(l.up0),q.subVectors(l.object.position,l.target),l.object.lookAt(l.target),l.dispatchEvent(z),n.copy(l.object.position)},this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",e,!1),this.domElement.addEventListener("mousewheel",h,!1),this.domElement.addEventListener("DOMMouseScroll",h,!1),this.domElement.addEventListener("touchstart",i,!1),this.domElement.addEventListener("touchend",k,!1),this.domElement.addEventListener("touchmove",j,!1),window.addEventListener("keydown",c,!1),window.addEventListener("keyup",d,!1),this.handleResize()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.PlaneBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};for(var e=a/2,f=b/2,g=c||1,h=d||1,i=g+1,j=h+1,k=a/g,l=b/h,m=new Float32Array(i*j*3),n=new Float32Array(i*j*3),o=new Float32Array(i*j*2),p=0,q=0,r=0;j>r;r++)for(var s=r*l-f,t=0;i>t;t++){var u=t*k-e;m[p]=u,m[p+1]=-s,n[p+2]=1,o[q]=t/g,o[q+1]=1-r/h,p+=3,q+=2}p=0;for(var v=new(m.length/3>65535?Uint32Array:Uint16Array)(g*h*6),r=0;h>r;r++)for(var t=0;g>t;t++){var w=t+i*r,x=t+i*(r+1),y=t+1+i*(r+1),z=t+1+i*r;v[p]=w,v[p+1]=x,v[p+2]=z,v[p+3]=x,v[p+4]=y,v[p+5]=z,p+=6}this.addAttribute("index",new THREE.BufferAttribute(v,1)),this.addAttribute("position",new THREE.BufferAttribute(m,3)),this.addAttribute("normal",new THREE.BufferAttribute(n,3)),this.addAttribute("uv",new THREE.BufferAttribute(o,2))},THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.SphereBufferGeometry=function(a,b,c,d,e,f,g){THREE.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g},a=a||50,b=Math.max(3,Math.floor(b)||8),c=Math.max(2,Math.floor(c)||6),d=void 0!==d?d:0,e=void 0!==e?e:2*Math.PI,f=void 0!==f?f:0,g=void 0!==g?g:Math.PI;var h=(b+1)*(c+1),i=new THREE.BufferAttribute(new Float32Array(3*h),3),j=new THREE.BufferAttribute(new Float32Array(3*h),3),k=new THREE.BufferAttribute(new Float32Array(2*h),2);this.addAttribute("position",i),this.addAttribute("normal",j),this.addAttribute("uv",k);var l,m,n,o,p,q,r,s=0,t=[],u=new THREE.Vector3;for(m=0;c>=m;m++){var v=[];for(o=m/c,l=0;b>=l;l++)n=l/b,p=-a*Math.cos(d+n*e)*Math.sin(f+o*g),q=a*Math.cos(f+o*g),r=a*Math.sin(d+n*e)*Math.sin(f+o*g),u.set(p,q,r).normalize(),i.setXYZ(s,p,q,r),j.setXYZ(s,u.x,u.y,u.z),k.setXY(s,n,1-o),v.push(s),s++;t.push(v)}var w,x=[];for(m=0,w=c-1;w>m;m++)for(l=0;b>l;l++){var y=t[m][l+1],z=t[m][l],A=t[m+1][l],B=t[m+1][l+1];0!==m&&x.push(y,z,B),x.push(z,A,B)}for(m=c,l=0;b>l;l++){var z=t[m][l],A=t[m-1][l],B=t[m-1][l+1];x.push(z,B,A)}this.addAttribute("index",new THREE.BufferAttribute(new Uint16Array(x),1)),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)},THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry,THREE.BasicShader={uniforms:{},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["void main() {","gl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );","}"].join("\n")},THREE.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},THREE.ConvolutionShader={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{type:"t",value:null},uImageIncrement:{type:"v2",value:new THREE.Vector2(.001953125,0)},cKernel:{type:"fv1",value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vec2 imageCoord = vUv;","vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n"),buildKernel:function(a){function b(a,b){return Math.exp(-(a*a)/(2*b*b))}var c,d,e,f,g=25,h=2*Math.ceil(3*a)+1;for(h>g&&(h=g),f=.5*(h-1),d=new Array(h),e=0,c=0;h>c;++c)d[c]=b(c-f,a),e+=d[c];for(c=0;h>c;++c)d[c]/=e;return d}},THREE.EffectComposer=function(a,b){if(this.renderer=a,void 0===b){var c=window.innerWidth||1,d=window.innerHeight||1,e={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1};b=new THREE.WebGLRenderTarget(c,d,e)}this.renderTarget1=b,this.renderTarget2=b.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},THREE.EffectComposer.prototype={swapBuffers:function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=a},addPass:function(a){this.passes.push(a)},insertPass:function(a,b){this.passes.splice(b,0,a)},render:function(a){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var b,c,d=!1,e=this.passes.length;for(c=0;e>c;c++)if(b=this.passes[c],b.enabled){if(b.render(this.renderer,this.writeBuffer,this.readBuffer,a,d),b.needsSwap){if(d){var f=this.renderer.context;f.stencilFunc(f.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,a),f.stencilFunc(f.EQUAL,1,4294967295)}this.swapBuffers()}b instanceof THREE.MaskPass?d=!0:b instanceof THREE.ClearMaskPass&&(d=!1)}},reset:function(a){void 0===a&&(a=this.renderTarget1.clone(),a.width=window.innerWidth,a.height=window.innerHeight),this.renderTarget1=a,this.renderTarget2=a.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(a,b){var c=this.renderTarget1.clone();c.width=a,c.height=b,this.reset(c)}},THREE.RenderPass=function(a,b,c,d,e){this.scene=a,this.camera=b,this.overrideMaterial=c,this.clearColor=d,this.clearAlpha=void 0!==e?e:1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},THREE.RenderPass.prototype={render:function(a,b,c,d){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(a.getClearColor()),this.oldClearAlpha=a.getClearAlpha(),a.setClearColor(this.clearColor,this.clearAlpha)),a.render(this.scene,this.camera,c,this.clear),this.clearColor&&a.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}},THREE.SavePass=function(a){void 0===THREE.CopyShader&&console.error("THREE.SavePass relies on THREE.CopyShader");var b=THREE.CopyShader;this.textureID="tDiffuse",this.uniforms=THREE.UniformsUtils.clone(b.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader}),this.renderTarget=a,void 0===this.renderTarget&&(this.renderTargetParameters={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1},this.renderTarget=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,this.renderTargetParameters)),this.enabled=!0,this.needsSwap=!1,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.SavePass.prototype={render:function(a,b,c,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c),this.quad.material=this.material,a.render(this.scene,this.camera,this.renderTarget,this.clear)}},THREE.ShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse",this.uniforms=THREE.UniformsUtils.clone(a.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.ShaderPass.prototype={render:function(a,b,c,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c),this.quad.material=this.material,this.renderToScreen?a.render(this.scene,this.camera):a.render(this.scene,this.camera,b,this.clear)}},THREE.TexturePass=function(a,b){void 0===THREE.CopyShader&&console.error("THREE.TexturePass relies on THREE.CopyShader");var c=THREE.CopyShader;this.uniforms=THREE.UniformsUtils.clone(c.uniforms),this.uniforms.opacity.value=void 0!==b?b:1,this.uniforms.tDiffuse.value=a,this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}),this.enabled=!0,this.needsSwap=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.TexturePass.prototype={render:function(a,b,c,d){this.quad.material=this.material,a.render(this.scene,this.camera,c)}},THREE.MaskPass=function(a,b){this.scene=a,this.camera=b,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype={render:function(a,b,c,d){var e=a.context;e.colorMask(!1,!1,!1,!1),e.depthMask(!1);var f,g;this.inverse?(f=0,g=1):(f=1,g=0),e.enable(e.STENCIL_TEST),e.stencilOp(e.REPLACE,e.REPLACE,e.REPLACE),e.stencilFunc(e.ALWAYS,f,4294967295),e.clearStencil(g),a.render(this.scene,this.camera,c,this.clear),a.render(this.scene,this.camera,b,this.clear),e.colorMask(!0,!0,!0,!0),e.depthMask(!0),e.stencilFunc(e.EQUAL,1,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}},THREE.ClearMaskPass=function(){this.enabled=!0},THREE.ClearMaskPass.prototype={render:function(a,b,c,d){var e=a.context;e.disable(e.STENCIL_TEST)}},THREE.BloomPass=function(a,b,c,d){a=void 0!==a?a:1,b=void 0!==b?b:25,c=void 0!==c?c:4,d=void 0!==d?d:256;var e={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat};this.renderTargetX=new THREE.WebGLRenderTarget(d,d,e),this.renderTargetY=new THREE.WebGLRenderTarget(d,d,e),void 0===THREE.CopyShader&&console.error("THREE.BloomPass relies on THREE.CopyShader");var f=THREE.CopyShader;this.copyUniforms=THREE.UniformsUtils.clone(f.uniforms),this.copyUniforms.opacity.value=a,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,blending:THREE.AdditiveBlending,transparent:!0}),void 0===THREE.ConvolutionShader&&console.error("THREE.BloomPass relies on THREE.ConvolutionShader");var g=THREE.ConvolutionShader;this.convolutionUniforms=THREE.UniformsUtils.clone(g.uniforms),this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurx,this.convolutionUniforms.cKernel.value=THREE.ConvolutionShader.buildKernel(c),this.materialConvolution=new THREE.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,defines:{KERNEL_SIZE_FLOAT:b.toFixed(1),KERNEL_SIZE_INT:b.toFixed(0)}}),this.enabled=!0,this.needsSwap=!1,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.BloomPass.prototype={render:function(a,b,c,d,e){e&&a.context.disable(a.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=c,this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurX,a.render(this.scene,this.camera,this.renderTargetX,!0),this.convolutionUniforms.tDiffuse.value=this.renderTargetX,this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurY,a.render(this.scene,this.camera,this.renderTargetY,!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY,e&&a.context.enable(a.context.STENCIL_TEST),a.render(this.scene,this.camera,c,this.clear)}},THREE.BloomPass.blurX=new THREE.Vector2(.001953125,0),THREE.BloomPass.blurY=new THREE.Vector2(0,.001953125),THREE.ShaderChunk.lerp_pos_pars_vertex=["uniform float time;","attribute vec3 positionPrev;"].join("\n"),THREE.ShaderChunk.lerp_pos_vertex=["vec4 mvPosition = modelViewMatrix * vec4(mix(positionPrev, position, time), 1.0);","gl_Position = projectionMatrix * mvPosition;"].join("\n"),this.App=this.App||{},this.App.shaders=this.App.shaders||{},this.App.shaders["alpha-frag"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function";return g+="uniform vec3 diffuse;\nuniform float opacity;\nvarying float vAlpha;\n\n",f=b&&b.chunks,f=null==f||f===!1?f:f.common,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.color_pars_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.uv_pars_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.uv2_pars_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.map_pars_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.alphamap_pars_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.shadowmap_pars_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.specularmap_pars_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\nvoid main() {\n  // outgoing light does not have an alpha, the surface does\n  vec3 outgoingLight = vec3(0.0);\n  vec4 diffuseColor = vec4(diffuse, opacity * vAlpha);\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.logdepthbuf_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.map_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.color_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.alphamap_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.alphatest_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.specularmap_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  // simple shader\n  outgoingLight = diffuseColor.rgb;\n\n  // TODO: this should be pre-multiplied to allow for bright highlights on very transparent objects\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n}\n"}),this.App.shaders["alpha-vert"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function";return g+="attribute float alpha;\nvarying float vAlpha;\n\n",f=b&&b.chunks,f=null==f||f===!1?f:f.common,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.map_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.lightmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.envmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.color_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.morphtarget_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.skinning_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.shadowmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.logdepthbuf_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\nvoid main() {\n  vAlpha = alpha;\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.map_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.lightmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.color_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinbase_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  #ifdef USE_ENVMAP\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.morphnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.defaultnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  #endif\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.morphtarget_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinning_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.default_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.logdepthbuf_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.worldpos_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.envmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.shadowmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n}\n"}),this.App.shaders["basic-vert"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function";return f=b&&b.chunks,f=null==f||f===!1?f:f.common,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.map_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.lightmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.envmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.color_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.morphtarget_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.skinning_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.shadowmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.logdepthbuf_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\nvoid main() {\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.map_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.lightmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.color_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinbase_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  #ifdef USE_ENVMAP\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.morphnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.defaultnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  #endif\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.morphtarget_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinning_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.default_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.logdepthbuf_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.worldpos_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.envmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.shadowmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n}\n"}),this.App.shaders["bulb-frag"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"uniform vec3 diffuse;\nuniform float opacity;\nvarying vec2 vUv;\n\nfloat scale = 20.0;\nfloat saturation = 2.0;\n\nvoid main() {\n  vec2 uv = vUv;\n\n  saturation -= sin(uv.x * 60.0) * 0.25 + sin(uv.x * 60.0 * scale) * 0.25 + 0.75;\n\n  saturation -= sin(uv.y * sin(uv.x         * 5.0) * 5.0 * scale) * 0.05;\n  saturation -= sin(uv.y * sin((1.0 - uv.x) * 5.0) * 5.0 * scale) * 0.05;\n\n  saturation -= sin(uv.y * sin(uv.y + cos(uv.x)       * 2.0) * 10.0 * scale) * 0.15;\n  saturation -= sin(uv.y * sin(uv.y + cos(1.0 - uv.x) * 2.0) * 10.0 * scale) * 0.15;\n\n  saturation -= sin((uv.y - 1.5) * sin(uv.y + cos(uv.x - 1.0)       * 2.0) * 8.0 * scale) * 0.15;\n  saturation -= sin((uv.y - 1.5) * sin(uv.y + cos(1.0 - uv.x - 1.0) * 2.0) * 8.0 * scale) * 0.15;\n\n  saturation -= sin(uv.y * 5.0) * 0.5 + sin(uv.y * 2.5) * 1.5;\n\n  gl_FragColor = vec4(diffuse * saturation, opacity * saturation);\n}\n"}),this.App.shaders["dust-frag"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"uniform vec3 psColor;\nuniform float opacity;\nuniform float area;\nvarying float centerDist;\n\nvoid main() {\n  float illumination = (area * 2.0 / (centerDist * centerDist));\n  gl_FragColor = vec4(psColor, illumination);\n}\n"}),this.App.shaders["dust-vert"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"uniform float size;\nuniform float scale;\nuniform float time;\nuniform float area;\nvarying float centerDist;\n\nvoid main() {\n  float offsetY = mod(position.y - 1.0 * time, area) - area * 0.5;\n  vec3 offsetPosition = vec3(\n    position.x + sin(cos(offsetY * 0.1) + sin(offsetY * 0.1 + position.x * 0.1) * 2.0),\n    offsetY,\n    position.z + sin(cos(offsetY * 0.1) + sin(offsetY * 0.1 + position.z * 0.1) * 2.0));\n\n  centerDist = length(offsetPosition);\n\n  vec4 mvPosition = modelViewMatrix * vec4(offsetPosition, 1.0);\n\n  gl_PointSize = size * (scale / length(mvPosition.xyz));\n  gl_Position = projectionMatrix * mvPosition;\n}\n"}),this.App.shaders["lerp-vert"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function";return f=b&&b.chunks,f=null==f||f===!1?f:f.common,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.lerp_pos_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.map_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.lightmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.envmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.color_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.morphtarget_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.skinning_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.shadowmap_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.logdepthbuf_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\nvoid main() {\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.map_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.lightmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,
f=null==f||f===!1?f:f.color_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinbase_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  #ifdef USE_ENVMAP\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.morphnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.defaultnormal_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  #endif\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.morphtarget_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.skinning_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.lerp_pos_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.logdepthbuf_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.worldpos_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.envmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.shadowmap_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n}\n"}),this.App.shaders["tail-frag"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"uniform vec3 diffuse;\nuniform float opacity;\nvarying vec2 vUv;\n\nfloat scale = 20.0;\nfloat saturation = 1.5;\n\nvoid main() {\n  vec2 uv = vUv;\n\n  saturation -= sin(uv.y * 10.0 * scale) * 0.45 + uv.y * 1.5 + sin(uv.x * 20.0 * scale) * 0.1 + 0.85;\n\n  saturation -= sin(uv.y * sin(uv.x         * 5.0) * 5.0 * scale) * 0.05;\n  saturation -= sin(uv.y * sin((1.0 - uv.x) * 5.0) * 5.0 * scale) * 0.05;\n\n  saturation -= sin(uv.y * sin(uv.y + cos(uv.x)       * 2.0) * 10.0 * scale) * 0.15;\n  saturation -= sin(uv.y * sin(uv.y + cos(1.0 - uv.x) * 2.0) * 10.0 * scale) * 0.15;\n\n  gl_FragColor = vec4(diffuse * saturation, opacity * saturation);\n}\n"}),this.App.shaders["tentacle-frag"]=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"uniform vec3 diffuse;\nuniform float opacity;\nuniform float area;\nvarying float centerDist;\n\nvoid main() {\n  float illumination = area * 2.0 / (centerDist * centerDist);\n  gl_FragColor = vec4(\n    mix(vec3(1.0), diffuse, clamp(illumination, 0.0, 1.25)),\n    clamp(opacity * illumination * illumination, 0.0, opacity));\n}\n"}),this.App.shaders["tentacle-vert"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function";return g+="uniform float area;\nvarying float centerDist;\n\n",f=b&&b.chunks,f=null==f||f===!1?f:f.common,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.lerp_pos_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.color_pars_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\nvoid main() {\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.color_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  centerDist = length(position);\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.lerp_pos_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.worldpos_vertex,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n}\n"}),this.App.shaders["uvs-frag"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function";return g+="uniform vec3 diffuse;\nuniform float opacity;\n\n",f=b&&b.chunks,f=null==f||f===!1?f:f.common,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n",f=b&&b.chunks,f=null==f||f===!1?f:f.map_pars_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\nvoid main() {\n  vec4 diffuseColor = vec4(diffuse, opacity);\n\n  ",f=b&&b.chunks,f=null==f||f===!1?f:f.map_fragment,f=typeof f===h?f.apply(b):f,(f||0===f)&&(g+=f),g+="\n\n  gl_FragColor = vec4(vUv.xy, 0.0, opacity);\n}\n"}),function(){function a(a){var c=b.Format,d=a.medusae.system,e=document.getElementById("particle-count"),f=document.getElementById("constraint-count"),g=document.getElementById("force-count"),h=d._localConstraints.reduce(function(a,b){return a+b._count},0);e.textContent=c.number(d._count),f.textContent=c.number(h),g.textContent=c.number(d._forces.length)}var b=Object.create({ctor:Particulate.ctor,log:window.console&&window.console.log.bind&&window.console.log.bind(window.console)||function(){},shaders:window.App&&window.App.shaders,showStats:!1,_register:{},register:function(a,b){this._register[a]=b},run:function(a){this._register[a]&&this._register[a].call(this)},toggleStats:function(){document.body.classList.toggle("show-info")}});window.App=b,b.register("index",function(){var c=b.MainScene.create(),d=b.ToggleComponent.create({name:"audio"}),e=b.ToggleComponent.create({name:"dots"}),f=b.ToggleComponent.create({name:"postfx",isActive:c.usePostFx});b.ModalComponent.create({name:"info"}),c.initItems(),c.initForces(),c.initAudio(),c.appendRenderer(),c.loop.start(),a(c),d.addListener(c,"toggleAudio"),f.addListener(c,"togglePostFx"),e.addListener(c,"toggleDots"),e.addListener(b,"toggleStats"),setTimeout(function(){d.toggleState()},2e3)}),b.register("tests",function(){document.body.className="testing"})}(),function(){var a=App.Faces={};a.quad=function(a,b,c,d,e){return e.push(a,b,c),e.push(c,d,a),e},a.radial=function(a,b,c,d){for(var e=0,f=c-1;f>e;e++)d.push(a,b+e+1,b+e);return d.push(a,b,b+c-1),d},a.rings=function(a,b,c,d){for(var e,f,g,h,i=0,j=c-1;j>i;i++)e=a+i,f=a+i+1,g=b+i+1,h=b+i,d.push(e,f,g),d.push(g,h,e);return e=a+c-1,f=a,g=b,h=b+c-1,d.push(e,f,g),d.push(g,h,e),d}}(),function(){var a=App.Format={};a.number=function(a){for(var b,c=(""+a).split(""),d="",e=0,f=c.length;f>e;e++)b=f-e-1,d+=c[e],b%3===0&&b>0&&(d+=",");return d},a.absoluteLength=function(a,b){for(a=""+a;a.length<b;)a="0"+a;return a}}(),function(){var a=App.Geometry={};a.point=function(a,b,c,d){return d.push(a,b,c),d},a.circle=function(a,b,c,d){for(var e=2*Math.PI/a,f=0,g=0;a>g;g++)d.push(Math.cos(f)*b,c,Math.sin(f)*b),f+=e;return d}}(),function(){var a=App.Links={};a.line=function(a,b,c){for(var d=0;b-1>d;d++)c.push(a+d,a+d+1);return c},a.loop=function(a,b,c){for(var d=0;b-1>d;d++)c.push(a+d,a+d+1);return c.push(a,a+b-1),c},a.rings=function(a,b,c,d){for(var e=0;c>e;e++)d.push(a+e,b+e);return d},a.ringsAsym=function(a,b,c,d,e){for(var f=0;d>f;f++)e.push(a+f,b+f*c);return e},a.radial=function(a,b,c,d){for(var e=0;c>e;e++)d.push(a,b+e);return d},a.radial2=function(a,b,c,d){for(var e=0;c-1>e;e++)d.push(b+e,a,b+e+1);return d.push(b+c-1,a,b),d},a.radial2(0,1,3,[]),a.loop3=function(a,b,c){for(var d=0;b-2>d;d++)c.push(a+d,a+d+1,a+d+2);return c.push(a+b-2,a+b-1,a),c.push(a+b-1,a,a+1),c}}(),function(){function a(a,b,c,d){function e(b){j+=b;var c=Math.floor(j/k);for(c>0&&(j-=c*k);c>0;)h.call(a,k),c--;var d=j/k;i.call(a,k,d)}function f(){if(m){var a=Date.now(),b=Math.min(l,a-g);e(b),requestAnimationFrame(f),g=a}}var g,h=a[b],i=a[c],j=0,k=d||1/30*1e3,l=k,m=!1;this.stop=function(){m=!1},this.start=function(){g=Date.now(),m=!0,f()},this.toggle=function(){m?this.stop():this.start()}}App.Looper=a,a.create=App.ctor(a)}(),function(){var a=App.Tweens={};a.factorTween=function(a,b){return function(c,d,e){var f=a[c];null==f&&(f=a[c]=d);var g=e||b;return a[c]+=(d-f)*g}},a.stepTween=function(a,b){return function(c,d,e){var f=a[c];if(null==f&&(f=a[c]=d),f===d)return f;var g=e||b,h=d>f?1:-1;return g>(d-f)*h?(a[c]=d,f):a[c]+=g*h}}}(),function(){function a(a){this._isEnabled=!0,this._urls={},this._soundNames=[],this._volume={},this._volumeTarget={},this._playing={},this.baseUrl=a.baseUrl,this.sounds={},this.volume=null==a.volume?1:a.volume,this.tweenVolume=b.factorTween(this._volume,.05)}var b=App.Tweens;App.AudioController=a,a.create=App.ctor(a),a.prototype.addSound=function(a,b){b=b||a;var c=this.baseUrl+a;this._soundNames.push(b),this._urls[b]=[c+".mp3",c+".ogg"]},a.prototype.createSound=function(a,b){var c=this.sounds[a];if(c)return c;b=b||{},b.urls=this._urls[a],c=new Howl(b),c.sid=a;var d=null==b.volume?1:b.volume;return this._volume[a]=d,this._volumeTarget[a]=d,this.sounds[a]=c,c},a.prototype.getSound=function(a){return this.sounds[a]||this.createSound(a)},a.prototype.playSound=function(a,b){if(this._isEnabled){var c=this.getSound(a);c&&(null!=b&&(this._volume[a]=this._volumeTarget[a]=b),this._playing[a]=!0,c.play())}},a.prototype.pauseSound=function(a){this._playing[a]&&(this.sounds[a].pause(),this._playing[a]=!1)},a.prototype.setVolume=function(a,b){this._volumeTarget[a]=b},a.prototype.stopSound=function(a){this.getSound(a).stop()},a.prototype.stopAllSounds=function(){for(var a,b=this._soundNames,c=this.sounds,d=0,e=b.length;e>d;d++)a=c[b[d]],a&&a.stop()},a.prototype.enableSound=function(){this._isEnabled=!0},a.prototype.disableSound=function(){this._isEnabled=!1,this.stopAllSounds()},a.prototype.update=function(){for(var a,b,c,d=this.sounds,e=this._soundNames,f=this._playing,g=this._volumeTarget,h=this.volume,i=0,j=e.length;j>i;i++)a=e[i],b=d[a],b&&b._loaded&&(c=this.tweenVolume(a,g[a]),1e-4>c&&f[a]?b.pause():(f[a]||this.playSound(a),b.volume(c*h)))}}(),function(){function a(a){a=a||{},this.max=0,this.current=0,this.updateFactor=a.updateFactor||.1,this.drawOffset=a.drawOffset||2,this.pxRatio=a.pixelRatio||window.devicePixelRatio,this.createBuffers(),this.setSize(a.width||380,a.height||24),this.createLineBuffer(),this.createElement(),this.setLabel(a.label||"")}App.GraphComponent=a,a.create=App.ctor(a),a.prototype.setSize=function(a,b){var c=this.pxRatio;this.width=a,this.height=b,this.fullWidth=a*c,this.fullHeight=b*c,this.canvas.width=this.buffer.width=this.fullWidth,this.canvas.height=this.buffer.height=this.fullHeight,this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"},a.prototype.appendTo=function(a){a.appendChild(this.element)},a.prototype.createElement=function(){var a=this.element=document.createElement("div"),b=document.createElement("div"),c=this._labelEl=document.createTextNode(""),d=this._valueEl=document.createTextNode(""),e=this.canvas;a.className="stats-item",b.className="label",e.className="graph",a.appendChild(e),a.appendChild(b),b.appendChild(c),b.appendChild(d)},a.prototype.setLabel=function(a){this._labelEl.textContent=a+" "},a.prototype.createBuffers=function(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.buffer=document.createElement("canvas"),this.btx=this.buffer.getContext("2d")},a.prototype.grayscale=function(a,b){return"rgba("+[a,a,a,b].join(",")+")"},a.prototype.createLineBuffer=function(){var a=this.fullHeight,b=this.pxRatio,c=document.createElement("canvas"),d=c.getContext("2d");c.width=b,c.height=2*a+10,d.fillStyle=this.grayscale(255,.7),d.fillRect(0,a,b,b),d.fillStyle=this.grayscale(255,.1),d.fillRect(0,a+2*b,b,a+10),this.line=c},a.prototype.start=function(){this._startTime=Date.now()},a.prototype.end=function(){this._endTime=Date.now()},a.prototype.reset=function(){this._startTime=this._endTime=0},a.prototype._startTime=0,a.prototype._endTime=0,a.prototype._textTick=0,a.prototype.update=function(){var a=this.fullWidth,b=this.fullHeight,c=this.pxRatio,d=this.drawOffset,e=this.buffer,f=this.canvas,g=this.btx,h=this.ctx,i=this._endTime-this._startTime,j=this.current+=(i-this.current)*this.updateFactor,k=this.max*=.99;j>k&&(k=this.max=j),g.clearRect(0,0,a,b),g.drawImage(f,-d*c,0,a,b),h.clearRect(0,0,a,b),h.drawImage(e,0,0,a,b),h.drawImage(this.line,0,j*b/(k||1),c,b,a-c,0,c,b),++this._textTick>6&&(this._textTick=0,this._valueEl.textContent=j.toFixed(3))}}(),function(){function a(a){var b=a.name,c=document.getElementById("cover-"+b),d=this.toggle=document.getElementById("toggle-"+b),e=this.modal=document.getElementById(b);this.isActive=!1,this._toggleClassName=d.className,this._modalClassName=e.className,d.addEventListener("click",this.toggleState.bind(this),!1),c.addEventListener("click",this.toggleState.bind(this),!1)}App.ModalComponent=a,a.create=App.ctor(a),a.prototype.toggleState=function(a){this.isActive?(this.modal.className=this._modalClassName,this.toggle.className=this._toggleClassName,this.isActive=!1):(this.modal.className+=" active",this.toggle.className+=" active",this.isActive=!0)}}(),function(){function a(a){var b=a.name,c=this.toggle=document.getElementById("toggle-"+b);this.isActive=null!=a.isActive?a.isActive:!1,this._toggleClassName=c.className,this._listeners=[],this.updateEl(),c.addEventListener("click",this.toggleState.bind(this),!1)}App.ToggleComponent=a,a.create=App.ctor(a),a.prototype.addListener=function(a,b){this._listeners.push({context:a,fn:b})},a.prototype.triggerListeners=function(){for(var a,b=this._listeners,c=0,d=b.length;d>c;c++)a=b[c],a.context[a.fn].call(a.context,this.isActive)},a.prototype.toggleState=function(a){this.isActive=!this.isActive,this.updateEl(),this.triggerListeners()},a.prototype.updateEl=function(){this.isActive?this.toggle.className+=" active":this.toggle.className=this._toggleClassName}}(),function(){function a(a,b,c,d){Particulate.PlaneConstraint.apply(this,arguments),this.distance=0}App.LocalPlaneConstraint=a,a.create=Particulate.ctor(a),a.prototype=Object.create(Particulate.PlaneConstraint.prototype),a.prototype.constructor=a,a.prototype.applyConstraint=function(a,b,c){var d=this.bufferVec3,e=this.indices,f=e[1],g=e[a+3],h=3*f,i=h+1,j=h+2,k=3*g,l=k+1,m=k+2;if(0===a&&this._calculateNormal(a,b),this._hasNormal){var n=d[0],o=d[1],p=d[2],q=b[k]-b[h],r=b[l]-b[i],s=b[m]-b[j],t=q*n+r*o+s*p;t>this.distance||(b[k]-=n*t,b[l]-=o*t,b[m]-=p*t)}}}(),function(){function a(a,b){b=b||{},Particulate.Force.apply(this,arguments),this.position=this.vector,this.intensity=null!=b.intensity?b.intensity:.05,this.setRadius(b.radius||0)}var b=Particulate.Math;App.PointRepulsorForce=a,a.create=Particulate.ctor(a),a.prototype=Object.create(Particulate.Force.prototype),a.prototype.constructor=a,a.prototype.setRadius=function(a){this._radius2=a*a},a.prototype.applyForce=function(a,c,d,e){var f=this.vector,g=a+1,h=a+2,i=d[a]-f[0],j=d[g]-f[1],k=d[h]-f[2],l=i*i+j*j+k*k,m=b.clamp(.001,100,l-this._radius2*this.intensity),n=1/m,o=b.clamp(0,10,n*n*n);c[a]+=i*o,c[g]+=j*o,c[h]+=k*o}}(),function(){function a(a){var b=App.shaders[a];return b({chunks:THREE.ShaderChunk})}function b(b){this.shader&&(this.uniforms=THREE.UniformsUtils.clone(this.shader.uniforms),this.attributes=THREE.UniformsUtils.clone(this.shader.attributes),this.setUniformParameters(b),THREE.ShaderMaterial.call(this,{uniforms:this.uniforms,attributes:this.attributes,fragmentShader:a(this.shader.fragmentShader),vertexShader:a(this.shader.vertexShader)}),this.transparent=b.transparent||!1,this.blending=b.blending||THREE.NormalBlending,this.side=b.side||THREE.FrontSide,this.linewidth=b.linewidth||1,this.depthTest=null!=b.depthTest?b.depthTest:!0,this.depthWrite=null!=b.depthWrite?b.depthWrite:!0,this.fog=!!b.fog,this.map=!!b.map,this.bumpMap=!!b.bumpMap,this.normalMap=!!b.normalMap,this.specularMap=!!b.specularMap)}App.ShaderMaterial=b,b.prototype=Object.create(THREE.ShaderMaterial.prototype),b.prototype.setUniformParameters=function(a){var b=this.uniforms;Object.keys(a).forEach(function(c){var d=b[c];if(d)switch(d.type){case"c":this[c]=b[c].value=new THREE.Color(a[c]);break;default:this[c]=b[c].value=a[c]}}.bind(this))}}(),function(){function a(a){a=a||{},b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.AlphaMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"alpha-vert",fragmentShader:"alpha-frag",uniforms:THREE.UniformsUtils.merge([c.common]),attributes:{alpha:{type:"f",value:null}}}}(),function(){function a(a){a=a||{},a.map=!0,b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.BulbMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"lerp-vert",fragmentShader:"bulb-frag",uniforms:THREE.UniformsUtils.merge([c.common,{time:{type:"f",value:0}}]),attributes:{positionPrev:{type:"v3",value:null}}}}(),function(){function a(a){a=a||{},b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.DustMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"dust-vert",fragmentShader:"dust-frag",uniforms:THREE.UniformsUtils.merge([c.particle,{time:{type:"f",value:0},area:{type:"f",value:1}}])}}(),function(){function a(a){a=a||{},a.map=!0,b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.TailMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"lerp-vert",fragmentShader:"tail-frag",uniforms:THREE.UniformsUtils.merge([c.common,{time:{type:"f",value:0}}]),attributes:{positionPrev:{type:"v3",value:null}}}}(),function(){function a(a){a=a||{},b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.TentacleMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"tentacle-vert",fragmentShader:"tentacle-frag",uniforms:THREE.UniformsUtils.merge([c.common,{time:{type:"f",value:0},area:{type:"f",value:1}}]),attributes:{positionPrev:{type:"v3",value:null}}}}(),function(){function a(a){a=a||{},a.map=!0,b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.UVMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"basic-vert",fragmentShader:"uvs-frag",uniforms:THREE.UniformsUtils.merge([c.common])}}(),function(){function a(a,b,c){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.texture=new THREE.Texture(this.canvas),this.drawTexture(a,b,c)}App.LensDirtTexture=a,a.prototype.grayscaleColor=function(a,b,c){var d=Math.floor(Math.random()*b)+a;return"rgba("+[d,d,d,c].join(",")+")"},a.prototype.createGradients=function(a,b,c){for(var d,e,f,g,h,i,j,k,l,m=2*Math.PI/(b+1),n=0,o=[],p=0;b>p;p++)i=Math.cos(n)*c,j=Math.sin(n)*c,k=Math.cos(n+Math.PI)*c,l=Math.sin(n+Math.PI)*c,f=.1*Math.random(),g=.5*Math.random(),d=this.grayscaleColor(100,100,f),e=this.grayscaleColor(100,100,g),h=a.createLinearGradient(i,j,k,l),h.addColorStop(.2,d),h.addColorStop(.8,e),o.push(h),h._alpha=g,n+=m;return o},a.prototype.drawBlob=function(a,b,c,d){var e,f,g,h,i=2*Math.PI/d,j=0,k=100*Math.random(),l=100*Math.random();a.beginPath();for(var m=0,n=d-1;n>m;m++)e=Math.cos(j)*b,f=Math.sin(j)*c,g=.01*(k+e),h=.01*(l+f),e+=5*noise.simplex2(g,h),f+=5*noise.simplex2(g,h),j+=i,0===m?a.moveTo(e,f):a.lineTo(e,f);a.closePath(),a.fill()},a.prototype.drawShadow=function(a,b){a.save(),a.shadowBlur=10,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowColor=this.grayscaleColor(200,10,1);for(var c=0;b>c;c++)a.stroke();a.restore()},a.prototype.drawTexture=function(a,b,c){c=c||{};var d,e,f,g,h=this.canvas,i=this.ctx,j=c.detail||10,k=c.cellPad||10,l=a/b,m=.5*l,n=.5*(l-k),o=.5*n,p=this.createGradients(i,b,l);h.width=h.height=a,i.lineWidth=1;for(var q=0;b>q;q++){i.setTransform(1,0,0,1,0,0),i.translate(0,l*q+m);for(var r=0;b>r;r++)i.translate(0===r?m:l,0),f=Math.random()*o+o,g=Math.random()*o+o,e=Math.floor(Math.random()*p.length),d=p[e],i.fillStyle=d,i.strokeStyle=this.grayscaleColor(60,30,.5*d._alpha),this.drawBlob(i,f,g,j),this.drawShadow(i,2)}this.texture.needsUpdate=!0}}(),function(){function a(a){a=a||{};var b=a.quads||100,c=a.textureSize||1024,d=a.textureCells||10,e=a.textureCellPad||20,f=a.textureDetail||50;this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!1,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.scale=1,this.textureMap=new App.LensDirtTexture(c,d,{detail:f,cellPad:e}),this.geom=this.createQuadGeom(b,d),this.mesh=new THREE.Mesh(this.geom,new App.AlphaMaterial({color:16777215,opacity:.5,map:this.textureMap.texture,blending:THREE.AdditiveBlending,transparent:!0})),this.scene.add(this.mesh),this._quadIndex=0,this._quadCount=b}App.LensDirtPass=a,a.prototype.setSize=function(a,b){var c,d,e,f=this.camera;a>b?(c=1,d=e=b/a):(c=e=a/b,d=1),f.left=-c,f.right=c,f.top=d,f.bottom=-d,this.scale=e,f.updateProjectionMatrix()},a.prototype._quadGeomPosition=function(a){var b=new Float32Array(4*a*3),c=new THREE.BufferAttribute(b,3);return c},a.prototype._quadGeomIndex=function(a){for(var b,c,d,e,f=new Uint16Array(6*a),g=new THREE.BufferAttribute(f,1),h=0,i=0,j=0;a>j;j++)b=h,c=h+1,d=h+2,e=h+3,f[i]=b,f[i+1]=c,f[i+2]=d,f[i+3]=d,f[i+4]=e,f[i+5]=b,h+=4,i+=6;return g},a.prototype._quadGeomUv=function(a,b){for(var c=new Float32Array(4*a*2),d=new THREE.BufferAttribute(c,2),e=1/b,f=0,g=0,h=0,i=0;a>i;i++)c[f]=c[f+6]=e*h,c[f+1]=c[f+3]=e*g,c[f+2]=c[f+4]=e*(h+1),c[f+5]=c[f+7]=e*(g+1),f+=8,++h===b&&(h=0,++g===b&&(g=0));return d},a.prototype._quadGeomAlpha=function(a){var b=new Float32Array(4*a),c=new THREE.BufferAttribute(b,1);return c},a.prototype.createQuadGeom=function(a,b){var c=new THREE.BufferGeometry;return c.addAttribute("position",this._quadGeomPosition(a)),c.addAttribute("index",this._quadGeomIndex(a)),c.addAttribute("uv",this._quadGeomUv(a,b)),c.addAttribute("alpha",this._quadGeomAlpha(a)),c},a.prototype._quadIndex=0,a.prototype.setQuadPosition=function(){var a=new THREE.Matrix4,b=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Matrix4,e=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3;return function(i,j,k,l,m){var n=this.geom.attributes.position,o=4*i,p=o+1,q=o+2,r=o+3;c.makeScale(m*this.scale,m*this.scale,1),b.makeRotationZ(l),a.makeTranslation(j,k,0),d.identity(),d.multiply(a),d.multiply(b),d.multiply(c),e.set(-1,-1,0),f.set(1,-1,0),g.set(1,1,0),h.set(-1,1,0),e.applyMatrix4(d),f.applyMatrix4(d),g.applyMatrix4(d),h.applyMatrix4(d),n.setXY(o,e.x,e.y),n.setXY(p,f.x,f.y),n.setXY(q,g.x,g.y),n.setXY(r,h.x,h.y),n.needsUpdate=!0}}(),a.prototype.setQuadAlpha=function(a,b){var c=this.geom.attributes.alpha,d=c.array,e=4*a;d[e]=b,d[e+1]=b,d[e+2]=b,d[e+3]=b,c.needsUpdate=!0},a.prototype.setGroup=function(a,b,c,d){for(var e,f,g,h,i=this._quadCount,j=this._quadIndex,k=j,l=0;a>l;l++)e=b+(Math.random()-.5)*d,f=c+(Math.random()-.5)*d,g=Math.random()*Math.PI*2,h=.15*Math.random(),this.setQuadPosition(k,e,f,g,h),this.setQuadAlpha(k,1),k=j+l,k>=i&&(j=this._quadIndex=0);this._quadIndex=k},a.prototype.update=function(a){for(var b=this.geom.attributes.alpha,c=b.array,d=0,e=c.length;e>d;d++)c[d]*=.995;b.needsUpdate=!0},a.prototype.render=function(a,b,c,d){this.renderToScreen?a.render(this.scene,this.camera):a.render(this.scene,this.camera,c,this.clear)}}(),function(){function a(a){this.pxRatio=a.pxRatio||1,this.particleSize=2*this.pxRatio,this.particleCount=1e4,this.area=100,this.createParticles(),this.createMaterials(),this.createItem()}App.Dust=a,a.create=App.ctor(a),a.prototype.createParticles=function(){for(var a,b=this.particleCount,c=this.geometry=new THREE.BufferGeometry,d=new Float32Array(3*b),e=this.area,f=.5*e,g=0,h=d.length/3;h>g;g++)a=3*g,d[a]=Math.random()*e-f,d[a+1]=Math.random()*e-f,d[a+2]=Math.random()*e-f;var i=new THREE.BufferAttribute;i.array=d,i.itemSize=3,c.addAttribute("position",i)},a.prototype.createMaterials=function(){var a=this.material=new App.DustMaterial({psColor:16777215,size:this.particleSize,scale:100,area:this.area,transparent:!0});this.timeAttr=a.uniforms.time},a.prototype.createItem=function(){this.item=new THREE.PointCloud(this.geometry,this.material)},a.prototype.addTo=function(a){a.add(this.item)},a.prototype.updateGraphics=function(a){this.timeAttr.value+=.005*a}}(),function(){function a(a){this.pxRatio=a.pxRatio||1,this.lineWidth=this.pxRatio,this.animTime=0,this.size=25,this.segmentsCount=8,this.totalSegments=3*this.segmentsCount*3,this.ribsCount=15,this.ribRadius=25,this.tentacleGroupStart=0,this.tentacleGroupOffset=2,this.tentacleGroupCount=6,this.tentacleSegments=100,this.tentacleSegmentLength=1.5,this.tentacleWeightFactor=.5,this.tailRibsCount=10,this.tailRibRadiusFactor=20,this.createTempBuffers(),this.createGeometry(),this.createSystem(),this.createSceneItem(),this.removeTempBuffers(),this.initTweens()}function b(a,b,c,d){for(var e=[],f=0;d>f;f++)e.push(a,b,c+f);return e}function c(a){return s(w-.55*w*a*1.8)+u(100*a+2)/3}function d(a,b,c,d){for(var e,f,g=v(c/3),h=0;3>h;h++)e=a+g*h,f=a+g*(h+1),d.push(b+e%c,b+f%c);return d}function e(a,b,c){for(var d,e,f=1,g=b;g>f;f++)d=f/b,e=2*(.5>=d?d:1-d),c.push(e,a);return c.push(0,a),c}function f(a,b){for(var c=0,d=a;d>c;c++)b.push(0,0);return b}function g(a){return s(.25*a*w+.5*w)*(1-.9*a)}function h(a){return function(b,c){c=c||this[a],x.apply(c,b)}}var i=Particulate,j=App.Geometry,k=App.Links,l=App.Faces,m=App.Tweens,n=i.Vec3,o=i.PointConstraint,p=i.DistanceConstraint,q=i.AngleConstraint,r=i.AxisConstraint,s=Math.sin,t=Math.cos,u=Math.log,v=Math.floor,w=Math.PI,x=Array.prototype.push;App.Medusae=a,a.create=App.ctor(a),a.tempBuffers=["queuedConstraints","verts","links","weights","bulbFaces","tailFaces","uvs","tentacles","tentLinks","skins"],a.prototype.createTempBuffers=function(){for(var b,c=a.tempBuffers,d=c.length-1;d>=0;d--)b=c[d],this[b]=[]},a.prototype.removeTempBuffers=function(){for(var b,c=a.tempBuffers,d=c.length-1;d>=0;d--)b=c[d],delete this[b]},a.prototype.createGeometry=function(){this.createCore(),this.createBulb(),this.createTail(),this.createTentacles()},a.prototype.createCore=function(){var a=this.verts,c=this.uvs,d=this.totalSegments,e=this.size,f=[e,0,2*-e,0,.5*-e,-e],g=this.topStart=f.length,h=this.indexTop=g-3,i=this.indexMid=g-2,k=this.indexBottom=g-1;this.pinTop=0,this.pinBottom=2;for(var m=[.4*e,.6*e],n=[.4*e,.6*e],o=[0,.5*e],s=p.create(m,[0,h]),t=p.create(m,[1,h]),u=p.create(n,[h,i]),v=p.create(o,[2,k]),x=r.create(0,1,[h,i,k]),y=q.create([.35*w,.65*w],b(this.pinTop,h,g,d)),z=0,A=f.length;A>z;z++)j.point(0,f[z],0,a),c.push(0,0);this.queueConstraints(s,t,u,v,x),this.queueConstraints(y),l.radial(h,g,d,this.bulbFaces)},a.prototype.createBulb=function(){var a=this.ribsCount;this.ribs=[];for(var b=0,c=a;c>b;b++)this.createRib(b,a),b>0&&this.createSkin(b-1,b)},a.prototype.createInnerRib=function(a,b){for(var c=this.segmentsCount,e=this.totalSegments,f=[],g=0,h=c;h>g;g++)d(3*g,a,e,f);return p.create([.8*b,b],f)},a.prototype.createRib=function(a,b){var d=this.totalSegments,f=this.verts,g=this.uvs,h=this.size,i=a/b,l=h-i*h,m=a*d+this.topStart,n=c(i),o=10*n+.5;j.circle(d,o,l,f),e(i,d,g);var q,r,s=k.loop(m,d,[]),t=2*w*o/d,u=p.create([.9*t,t],s),v=2*w*o/3,x=this.createInnerRib(m,v);(0===a||a===b-1)&&(r=0===a?this.indexTop:this.indexBottom,q=p.create([.8*o,o],k.radial(r,m,d,[])),this.queueConstraints(q),0===a&&this.addLinks(q.indices)),this.queueConstraints(u,x),this.ribs.push({start:m,radius:o,yParam:i,yPos:l,outer:u,inner:x,spine:q})},a.prototype.createSkin=function(a,b){var c=this.totalSegments,d=this.ribs[a],e=this.ribs[b],f=n.distance(this.verts,d.start,e.start),g=p.create([.5*f,f],k.rings(d.start,e.start,c,[]));this.queueConstraints(g),this.addLinks(g.indices),l.rings(d.start,e.start,c,this.bulbFaces),this.skins.push({a:a,b:b})},a.prototype.updateRibs=function(a,b){for(var c,d,e,f,g,h=this.animTime,i=.5*(s(h)+1),j=15,k=this.totalSegments,l=0,m=a.length;m>l;l++)c=a[l],d=c.radius+c.yParam*i*j,e=(c.radiusOuter||c.radius)+c.yParam*i*j,f=2*w*e/k,g=2*w*d/3,c.outer&&c.outer.setDistance(.9*f,f),c.inner&&c.inner.setDistance(.8*g,g),c.spine&&c.spine.setDistance(.8*d,d)},a.prototype.createTentacles=function(){for(var a=this.tentacleGroupCount,b=0,c=a;c>b;b++)this.createTentacleGroup(b,a)},a.prototype.createTentacleGroup=function(a,b){for(var c=this.tentacleRib(a),d=a/b,e=this.tentacleSegments,f=e*d*.25+.75*e,g=0,h=f;h>g;g++)this.createTentacleSegment(a,g,f,c),g>0?this.linkTentacle(a,g-1,g):this.attachTentacles(a,c)},a.prototype.tentacleRib=function(a){var b=this.ribs,c=this.tailRibs,d=this.tentacleGroupStart+this.tentacleGroupOffset*a;return c[c.length-d-1]||b[b.length-d+c.length-1]},a.prototype.createTentacleSegment=function(a,b,c,d){var e=this.totalSegments,g=this.verts,h=this.uvs,i=d.radius*(.25*s(.25*b)+.5),k=-b*this.tentacleSegmentLength,l=g.length/3;j.circle(e,i,k,g),f(e,h),this.queueWeights(l,e,b/c*this.tentacleWeightFactor),0===b&&this.tentacles.push([]),this.tentacles[a].push({start:l})},a.prototype.attachTentacles=function(a,b){var c=this.tentacles[a][0],d=this.totalSegments,e=this.tentacleSegmentLength,f=p.create([.5*e,e],k.rings(b.start,c.start,d,[]));this.queueConstraints(f),this.addLinks(f.indices,this.tentLinks)},a.prototype.linkTentacle=function(a,b,c){var d=this.totalSegments,e=this.tentacles[a],f=e[b],g=e[c],h=this.tentacleSegmentLength,i=p.create([.5*h,h],k.rings(f.start,g.start,d,[]));this.queueConstraints(i),this.addLinks(i.indices,this.tentLinks)},a.prototype.createTail=function(){var a=this.tailRibsCount;this.tailRibs=[];for(var b=0,c=a;c>b;b++)this.createTailRib(b,a),this.createTailSkin(b-1,b)},a.prototype.createTailRib=function(a,b){var c=this.ribs[this.ribs.length-1],d=this.totalSegments,f=this.verts,h=this.uvs,i=this.size,l=a/b,m=c.yPos-l*i*.9,n=this.verts.length/3,o=g(l),q=o*c.radius,r=q+l*this.tailRibRadiusFactor;j.circle(d,q,m,f),e(l,d,h);var s,t,u=k.loop(n,d,[]),v=2*w*r/d,x=p.create([.9*v,1.5*v],u),y=2*w*q/3,z=this.createInnerRib(n,y);a===b-1&&(t=this.indexMid,s=p.create([.8*q,q],k.radial(t,n,d,[])),this.queueConstraints(s)),this.queueConstraints(x,z),this.tailRibs.push({start:n,yParam:1-l,radius:q,radiusOuter:r,inner:z,outer:x,spine:s})},a.prototype.createTailSkin=function(a,b){var c=this.totalSegments,d=0>a?this.ribs[this.ribs.length-1]:this.tailRibs[a],e=this.tailRibs[b],f=n.distance(this.verts,d.start,e.start),g=p.create([.5*f,f],k.rings(d.start,e.start,c,[]));this.queueConstraints(g),this.addLinks(g.indices),l.rings(d.start,e.start,c,this.tailFaces)},a.prototype.createTailFin=function(a,b){for(var c,d,e,f,g,h,i=this.size,m=this.tailSegments,n=this.tailSegmentSize,o=1.8*n,q=this.tailRadius,r=20,u=i,v=this.verts,x=this.uvs,y=v.length/3,z=y+m-1,A=y+m,B=k.line(y,m,[this.indexMid,y]),C=k.line(A,m,[]),D=[],E=[],F=[],G=2*Math.PI*a/b,H=0;m>H;H++)j.point(0,u-H*n,0,v),x.push(0,H/(m-1));for(H=0;m>H;H++)f=y+H,g=A+H,h=s(H/(m-1)*w*.8)*q,c=t(G)*h,e=s(G)*h,d=u-H*o,j.point(c,d,e,v),x.push(1,H/(m-1)),E.push(f,g),D.push(p.create(h,f,g)),H>10&&F.push(f-10,g),H>1&&l.quad(f-1,g-1,g,f,this.tailFaces);var I=p.create([.25*n,n],B),J=p.create([.25*o,o],C),K=p.create([.5*h,1/0],F),L=p.create([0,r],z,this.pinBottom);this.queueConstraints(I,J,K,L),this.queueConstraints(D),this.queueWeights(y,2*m,a/b*this.tailWeightFactor),this.addLinks(C)},a.prototype.queueConstraints=function(a){x.apply(this.queuedConstraints,a.length?a:arguments)},a.prototype.queueWeights=function(a,b,c){var d,e,f=this.weights,g=a+b;if(f.length-1<g)for(d=0,e=g-f.length;e>d;d++)f.push(1);for(d=a,e=g;e>d;d++)f[d]=c},a.prototype.createSystem=function(){for(var a=this.queuedConstraints,b=this.weights,c=this.system=i.ParticleSystem.create(this.verts,2),d=this.size,e=0,f=a.length;f>e;e++)c.addConstraint(a[e]);for(e=0,f=b.length;f>e;e++)c.weights[e]=b[e];c.setWeight(0,0),c.setWeight(1,0),c.setWeight(2,0),c.addPinConstraint(o.create([0,d,0],0)),c.addPinConstraint(o.create([0,0,0],1)),c.addPinConstraint(o.create([0,1.5*-d,0],2))},a.prototype.relax=function(a){for(var b=this.system,c=0;a>c;c++)b.tick(1)},a.prototype.addLinks=h("links"),a.prototype.addFaces=h("bulbFaces"),a.prototype.addTimeAttr=function(a){this.timeAttrs||(this.timeAttrs=[]),this.timeAttrs.push(a.material.uniforms.time)},a.prototype.createSceneItem=function(){this.item=new THREE.Group,this.position=new THREE.BufferAttribute(this.system.positions,3),this.positionPrev=new THREE.BufferAttribute(this.system.positionsPrev,3),this.uvs=new THREE.BufferAttribute(new Float32Array(this.uvs),2),this.timeAttrs=[],this.createMaterialsDots(),this.createMaterialsLines(),this.createMaterialsTentacles(),this.createMaterialsBulb(),this.createMaterialsTail(),this.positionAttr=this.linesFore.geometry.attributes.position,this.positionPrevAttr=this.linesFore.geometry.attributes.positionPrev,this.item.position.setY(20);

},a.prototype.createTextureDots=function(){var a=document.createElement("canvas"),b=new THREE.Texture(a),c=a.getContext("2d"),d=Math.pow(2,6),e=.5*d,f=0;return a.width=a.height=d,c.lineWidth=.25*d,c.strokeStyle="#fff",c.beginPath(),c.moveTo(e,f),c.lineTo(e,d-f),c.moveTo(f,e),c.lineTo(d-f,e),c.stroke(),b.needsUpdate=!0,b},a.prototype.createMaterialsDots=function(){var a=new THREE.BufferGeometry;a.addAttribute("position",this.position);var b=this.dots=new THREE.PointCloud(a,new THREE.PointCloudMaterial({size:2*this.pxRatio,opacity:.5,map:this.createTextureDots(),transparent:!0,depthTest:!1,depthWrite:!1}));this.item.add(b)},a.prototype.createMaterialsLines=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.links),1),c=400,d=1.1;a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.addAttribute("index",b);var e=this.linesFaint=new THREE.Line(a,new App.TentacleMaterial({color:16777215,area:c,opacity:.25,linewidth:this.lineWidth,transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1}),THREE.LinePieces),f=this.linesFore=new THREE.Line(a,new App.TentacleMaterial({diffuse:16359101,area:c,opacity:.5,linewidth:this.lineWidth,transparent:!0,blending:THREE.AdditiveBlending}),THREE.LinePieces);e.scale.multiplyScalar(d),f.scale.multiplyScalar(d),this.addTimeAttr(e),this.addTimeAttr(f),this.item.add(e),this.item.add(f)},a.prototype.createMaterialsTentacles=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.tentLinks),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.addAttribute("index",b);var c=this.tentacleFore=new THREE.Line(a,new App.TentacleMaterial({diffuse:16359101,area:600,linewidth:this.lineWidth,transparent:!0,blending:THREE.AdditiveBlending,opacity:.25,depthTest:!0,depthWrite:!1}),THREE.LinePieces);this.addTimeAttr(c),this.item.add(c)},a.prototype.createMaterialsBulb=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.bulbFaces),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.addAttribute("uv",this.uvs),a.addAttribute("index",b);var c=this.bulbMesh=new THREE.Mesh(a,new App.BulbMaterial({diffuse:new THREE.Color(1.6,1,1.2)}));this.addTimeAttr(c),this.item.add(c)},a.prototype.createMaterialsTail=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.tailFaces),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.addAttribute("uv",this.uvs),a.addAttribute("index",b);var c=this.tailMesh=new THREE.Mesh(a,new App.TailMaterial({diffuse:new THREE.Color(1.6,1,1.2)}));this.addTimeAttr(c),this.item.add(c)},a.prototype.addTo=function(a){a.add(this.item)},a.prototype.toggleDots=function(){var a=this._dotsAreVisible=!this._dotsAreVisible;this._dotsOpacity=a?.75:0},a.prototype.initTweens=function(){this._tweens={},this.tween=m.factorTween(this._tweens,.05)},a.prototype.updateTweens=function(a){var b=this.tween("dots",this._dotsOpacity||0);this.dots.material.opacity=.5*b,this.dots.visible=b>.001,this.tweensNeedUpdate=Math.abs(b-this._dotsOpacity)>.001},a.prototype.update=function(a){this.animTime+=.001*a,this.updateRibs(this.ribs,a),this.updateRibs(this.tailRibs,a),this.updateTweens(a),this.system.tick(.001*a),this.positionAttr.needsUpdate=!0,this.positionPrevAttr.needsUpdate=!0},a.prototype.updateGraphics=function(a,b){for(var c=this.timeAttrs,d=0;d<c.length;d++)c[d].value=b}}(),function(){function a(){var a=this.scene=new THREE.Scene,c=this.camera=new THREE.PerspectiveCamera(30,1,5,3500),d=this.element=document.getElementById("container");this.statsElement=document.getElementById("container-graphs"),this.mouse=new THREE.Vector2,this.raycaster=new THREE.Raycaster,this.pxRatio=b.clamp(1.5,2,window.devicePixelRatio),this.gravity=-2,this.usePostFx=!0,this.shouldAnimate=!0,this.initRenderer(),this.initFxComposer(),this.addPostFx(),this.initControls(),this.initStats(),this.onWindowResize(),c.position.set(200,100,0),c.lookAt(a.position),this.loop=App.Looper.create(this,"update","preRender",1/30*1e3),d.addEventListener("mousedown",this.onMouseDown.bind(this),!1),d.addEventListener("mousemove",this.onMouseMove.bind(this),!1),d.addEventListener("mouseup",this.onMouseUp.bind(this),!1),document.addEventListener("keyup",this.onDocumentKey.bind(this),!1),window.addEventListener("resize",this.onWindowResize.bind(this),!1)}var b=Particulate.Math,c=!0,d=!1,e=!1;App.MainScene=a,a.create=App.ctor(a),a.prototype.initRenderer=function(){var a=this.renderer=new THREE.WebGLRenderer({antialias:!1});a.setClearColor(1118481,1),a.setPixelRatio(this.pxRatio),a.autoClear=!1},a.prototype.appendRenderer=function(){var a=this.renderer.domElement;this.element.appendChild(a),setTimeout(function(){a.className="active"},0)},a.prototype.initFxComposer=function(){var a=new THREE.WebGLRenderTarget(this.width,this.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearMipMapLinearFilter,format:THREE.RGBAFormat});this.composer=new THREE.EffectComposer(this.renderer,a),this._passIndex={}},a.prototype.addPostFx=function(){var a=.8,b=30,c=8,d=256,e=new THREE.RenderPass(this.scene,this.camera),f=new THREE.BloomPass(a,b,c,d),g=new THREE.ShaderPass(THREE.CopyShader),h=this.lensDirtPass=new App.LensDirtPass({quads:200,textureSize:2048});this.addPass(e),this.addPass(f),this.addPass(h),this.addPass(g,!0)},a.prototype.addPass=function(a,b,c){return"string"==typeof a?this._passIndex[a]=b:(c=b,b=a),b.renderToScreen=c||!1,this.composer.addPass(b),b},a.prototype.getPass=function(a){return this._passIndex[a]},a.prototype.enablePass=function(a){var b=this.getPass(a);b&&(b.enabled=!0)},a.prototype.disablePass=function(a){var b=this.getPass(a);b&&(b.enabled=!1)},a.prototype.initItems=function(){var a=this.medusae=App.Medusae.create({pxRatio:this.pxRatio}),b=this.dust=App.Dust.create({pxRatio:this.pxRatio});a.addTo(this.scene),b.addTo(this.scene)},a.prototype.togglePostFx=function(a){this.usePostFx=a},a.prototype.onWindowResize=function(){var a=window.innerWidth,b=window.innerHeight,c=this.pxRatio,d=a*c,e=b*c;this.width=a,this.height=b,this.camera.aspect=a/b,this.camera.updateProjectionMatrix(),this.renderer.setSize(a,b),this.composer.setSize(d,e),this.lensDirtPass.setSize(d,e),this.needsRender=!0},a.prototype.initForces=function(){var a=this.medusae,b=this.gravityForce=Particulate.DirectionalForce.create(),c=50,d=this.nudgeForce=App.PointRepulsorForce.create([20,5,0],{radius:c,intensity:0});a.relax(25),a.system.addForce(b),a.system.addForce(d),e&&this.initDebugNudge(c)},a.prototype.initDebugNudge=function(a){var b=this.debugNudge=new THREE.Mesh(new THREE.SphereBufferGeometry(a,8,6),new THREE.MeshBasicMaterial({color:16777215,opacity:.2,transparent:!0})),c=new THREE.WireframeHelper(b,16777215);this.scene.add(c),this.scene.add(b)},a.prototype.updateDebugNudge=function(){var a=this.nudgeForce,b=a.position,c=Math.max(a.intensity,1e-4),d=this.debugNudge;d.scale.set(c,c,c),d.position.set(b[0],b[1],b[2])},a.prototype.initControls=function(){var a=new THREE.TrackballControls(this.camera,this.element);a.rotateSpeed=.75,a.zoomSpeed=.75,a.panSpeed=.6,a.minDistance=50,a.maxDistance=300,a.noZoom=!c,a.noPan=!d,a.staticMoving=!1,a.dynamicDampingFactor=.2,a.keys=[65,17,16],a.addEventListener("change",this.onControlsChange.bind(this)),this.controls=a,this.controlsUp=a.object.up},a.prototype.onControlsChange=function(){this.needsRender=!0},a.prototype.onDocumentKey=function(a){switch(a.which){case 32:this.shouldAnimate=!this.shouldAnimate,a.preventDefault()}},a.prototype.onMouseDown=function(a){this.didDrag=!1},a.prototype.onMouseMove=function(a){this.didDrag=!0},a.prototype.onMouseUp=function(a){if(!this.didDrag&&this.shouldAnimate){var b=this.mouse;b.x=a.clientX/window.innerWidth*2-1,b.y=2*-(a.clientY/window.innerHeight)+1,this.nudgeMedusae(),a.preventDefault()}},a.prototype.nudgeMedusae=function(){var a=new THREE.Vector3;return function(){var b=this.raycaster,c=this.mouse;b.setFromCamera(c,this.camera);var d=b.intersectObject(this.medusae.bulbMesh);if(d.length){var e=this.nudgeForce,f=d[0].point,g=Math.random()>.5?"bubbles1":"bubbles2";a.copy(f).normalize().multiplyScalar(20),f.add(a),e.intensity=1,e.set(f.x,f.y,f.z),this.audio.playSound(g,.15),this.lensDirtPass.setGroup(10,c.x,c.y,.8)}}}(),a.prototype.initAudio=function(){var a=this.audio=App.AudioController.create({baseUrl:App.STATIC_URL+"audio/",volume:.8});a.addSound("bg-loop","bgLoop"),a.addSound("bubbles-1","bubbles1"),a.addSound("bubbles-2","bubbles2"),a.createSound("bgLoop",{loop:!0,volume:0})},a.prototype.beginAudio=function(){var a=this.audio;a.playSound("bgLoop"),a.setVolume("bgLoop",1),this._audioIsPlaying=!0},a.prototype.pauseAudio=function(){var a=this.audio;a.setVolume("bgLoop",0),this._audioIsPlaying=!1},a.prototype.toggleAudio=function(){this._audioIsPlaying?this.pauseAudio():this.beginAudio()},a.prototype.toggleDots=function(){this.medusae&&this.medusae.toggleDots()},a.prototype.initStats=function(){var a=this.statsElement;this.statsPhysics=App.GraphComponent.create({label:"Physics (ms)"}),this.statsGraphics=App.GraphComponent.create({label:"Graphics (ms)",updateFactor:.025}),this.statsPost=App.GraphComponent.create({label:"Post FX (ms)",updateFactor:.025}),this.statsPhysics.appendTo(a),this.statsGraphics.appendTo(a),this.statsPost.appendTo(a)},a.prototype.update=function(a){var b=this.controlsUp,c=this.gravity,d=this.gravityForce,f=this.nudgeForce;d.set(b.x*c*.2,b.y*c,b.z*c*.2),f.intensity*=.8,this.shouldAnimate?(this.statsPhysics.start(),this.medusae.update(a),this.statsPhysics.end(),this.lensDirtPass.update(a)):(this.statsPhysics.reset(),this.medusae.updateTweens(a),this.needsRender=this.medusae.tweensNeedUpdate),this.audio.update(a),e&&this.updateDebugNudge(a)},a.prototype.preRender=function(a,b){this.controls.update(),this.shouldAnimate||this.needsRender?(this.render(a,b),this.needsRender=!1):(this.statsGraphics.reset(),this.statsPost.reset()),this.statsPhysics.update(),this.statsGraphics.update(),this.statsPost.update()},a.prototype.render=function(a,b){this.statsGraphics.start(),this.shouldAnimate&&(this.medusae.updateGraphics(a,b),this.dust.updateGraphics(a,b)),this.usePostFx?(this.statsPost.start(),this.composer.render(.01),this.statsPost.end()):(this.statsPost.reset(),this.renderer.render(this.scene,this.camera)),this.statsGraphics.end()}}(),function(){setTimeout(function(){var a=!0;a&&location.search.indexOf("test=true")>-1?App.run("tests"):(App.run("index"),App.log("Particulate.js "+Particulate.VERSION))},0)}();